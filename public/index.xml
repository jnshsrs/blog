<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Science, Physiotherapy and Stats</title>
    <link>/</link>
    <description>Recent content on Science, Physiotherapy and Stats</description>
    <generator>Hugo - gohugo.io</generator>
    <language>en</language>
    <contact>jenshuesers@gmail.com</contact>
    <copyright>&copy; <a href="https://github.com/jnshsrs">Jens Hüsers</a> 2018</copyright>
    
        <atom:link href="/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>Profiling and Slicing an FHIR Observation Resource</title>
      <link>/post/profiling-and-slicing-an-fhir-observation-resource/</link>
      <pubDate>Thu, 25 Apr 2019 00:00:00 +0000</pubDate>
      <author>Jens Hüsers</author>
      <guid>/post/profiling-and-slicing-an-fhir-observation-resource/</guid>
      <description></description>
      
      <content>&lt;div id=&#34;introduction&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Introduction&lt;/h1&gt;
&lt;p&gt;This post is about creating FHIR profiles and slicing in particular. So, just before I start I want to introduce with a few bullet points to show from where this post starts.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Observation is a common entity in clinical care&lt;/li&gt;
&lt;li&gt;It is an FHIR resource helping to represent and store informations about an observation made in clinic practise&lt;/li&gt;
&lt;li&gt;The FHIR resource observation is normative amon only few more resources&lt;/li&gt;
&lt;li&gt;We can use the FHIR resource to represent clinical observations and store them on electronisch systems&lt;/li&gt;
&lt;li&gt;An observation may be the blood pressure or the size of a wound, to only name two out of many&lt;/li&gt;
&lt;li&gt;The FHIR specification is a framework of rules how to represent clinical information as listed above&lt;/li&gt;
&lt;li&gt;We can apply these rules to represent specific use cases e.g. observations such as blood pressure&lt;/li&gt;
&lt;li&gt;Appling these rules to a resource is called profiling&lt;/li&gt;
&lt;li&gt;&lt;p&gt;We can use profiling to specifiy how we want to use the FHIR resource to represent an blood pressure observation, e.g. by using fixed values and clinical code systems such as LOINC or SNOMED CT which represent clinical concepts&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;The next section discusses some parts of the profiling process and focusses on the slicing procedure&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;why-slicing&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Why slicing&lt;/h1&gt;
&lt;p&gt;As I was profiling a FHIR observation resource with Forge, I copied a profiling strategy from the FHIR core specification. This profile was about the vital sign &lt;em&gt;blood pressure&lt;/em&gt; which is represented by the systolic and the diastolic blood pressure. Following this logic, the profile captures blood pressure using two distinct values. In order to encode both values, the core specification uses the componente element of the observation resource which is sliced.&lt;/p&gt;
&lt;p&gt;Slicing is an operation in the profiling process to create multiple instances of an element. In other words, if we want to use a specific element of a resource multiple times, we literally copy the element in the process of slicing. In this case two component elements are created by the slicing operation, one representing the systolic part and the other representing the diastolic part of the blood pressure element. The element component of the resource &lt;code&gt;observation&lt;/code&gt; has the datatype &lt;code&gt;BackboneElement&lt;/code&gt; and two main elements: &lt;code&gt;code&lt;/code&gt; and &lt;code&gt;value&lt;/code&gt;. The &lt;code&gt;code&lt;/code&gt; element holds information about the kind of observation using code systems such as LOINC or SNOMED CT, e.g. the LOINC code &lt;code&gt;8480-6&lt;/code&gt; represents the concept of &lt;em&gt;diastolic blood pressure&lt;/em&gt;. The &lt;code&gt;value&lt;/code&gt; elments holds information about the actual value of the observation in a unit such as &lt;em&gt;mmHg&lt;/em&gt; to describe the diastolic pressure.&lt;/p&gt;
&lt;p&gt;The two components of blood pressure, i.e. systolic and diastolic, are each represented as an individual component. In order to differentiate between both components, slices have **discriminators*. Discriminators are elements within the parent element and have a path and a type. The type describes the kind of the slice and the path is a FHIR path of an element which actually discrinates.&lt;/p&gt;
&lt;p&gt;The blood pressure profile uses the &lt;code&gt;code.coding.code&lt;/code&gt; element as discriminator by specifing a value. The discriminator of of the blood pressure profile is the element &lt;code&gt;code.coding.code&lt;/code&gt;, represented as a FHIR path. As the name of the path suggests, the discriminator element is defined by a certain &lt;em&gt;code value&lt;/em&gt;. In this example, the profile uses &lt;em&gt;LOINC&lt;/em&gt; as code system and the codes &lt;code&gt;8480-6&lt;/code&gt; and &lt;code&gt;8480-6&lt;/code&gt; to represent diastolic and systolic blood pressure respectivly.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;another-slice-in-component---but-why&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Another slice in component - but why?&lt;/h1&gt;
&lt;p&gt;Additionally, the profile &lt;em&gt;blood pressure&lt;/em&gt; has also slices on the &lt;code&gt;code.coding&lt;/code&gt;. This element is part of the &lt;code&gt;component&lt;/code&gt; element. element of the parent element &lt;code&gt;component&lt;/code&gt; (The &lt;code&gt;componenent&lt;/code&gt; element furthermore has child elements &lt;code&gt;value[x]&lt;/code&gt;, &lt;code&gt;dataAbsentReason&lt;/code&gt;, &lt;code&gt;interpretation&lt;/code&gt; and &lt;code&gt;referenceRange&lt;/code&gt;). To make it more complicated, the abovementioned &lt;code&gt;code.coding&lt;/code&gt; element contains another &lt;code&gt;code&lt;/code&gt; element. I want to emphasise that two things:&lt;/p&gt;
&lt;p&gt;1.) This specific element is the discriminator of the first slice on &lt;code&gt;component&lt;/code&gt; (to be specific, the FHIR path is &lt;code&gt;code.coding.code&lt;/code&gt; which we have already seen above as the path of the first discriminator).&lt;/p&gt;
&lt;p&gt;2.) This element &lt;code&gt;code.coding.code&lt;/code&gt; is sliced again in the core FIHR profile of &lt;em&gt;blood pressure&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;During the time when I familiarized myself with this &lt;em&gt;blood pressure&lt;/em&gt; profile this seemed unreasonable to me. In my eyes the second slice on &lt;code&gt;code.coding&lt;/code&gt; was not nessecary at all. However, since this profile is published as part of the official core FHIR profiles, there must be a good reason for them to do so.&lt;/p&gt;
&lt;p&gt;In this section I will present my explaination why I think the authors of the FHIR core profile &lt;em&gt;blood pressure&lt;/em&gt; decided to choose to do so, that is, slice again on the sliced element.&lt;/p&gt;
&lt;p&gt;In the previous section of this post, I compared the process of slicing with copying an element we want to use in a profile multiple times. I think this is the reason why the authors sliced &lt;code&gt;code.coding.code&lt;/code&gt; again: In slicing this element, the profile enables the use of multiple elements of the specific &lt;code&gt;component&lt;/code&gt;. Here, an example might provide a clearer view on the described situation.&lt;/p&gt;
&lt;p&gt;In the use case of &lt;em&gt;blood pressure&lt;/em&gt;, we now know that it has two components, one of them is diastolic blood pressure. To map the sliced component with the concept of diastolic blood pressure, a code from a code system can be used. In this scenario, the authors choosed to represent diastolic blood pressure with a LOINC code and is used as a fixed value of the &lt;code&gt;code.coding.code&lt;/code&gt; element, which, remember, is the discriminator of the sliced &lt;code&gt;component&lt;/code&gt; element.&lt;/p&gt;
&lt;p&gt;However, it is possible to represent the concept of &lt;em&gt;diastolic blood pressure&lt;/em&gt; with other code systems, such as SNOMED CT or even MeSH Terms. By slicing the &lt;code&gt;code.coding.code&lt;/code&gt; element, the strategy of slicing again enables future implementers of this profile to define and use further codes. This means, that this profile will always represent &lt;em&gt;diastolic blood pressure&lt;/em&gt; with a LOINC code, but other code can used as well. If instead the &lt;code&gt;code.coding.code&lt;/code&gt; element is not sliced, future implementers cannot add synonymous codes to the component &lt;em&gt;diastolic blood pressure&lt;/em&gt; and I will illustrate both situations by providing profiles.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;example-profiles&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Example Profiles&lt;/h1&gt;
&lt;p&gt;The first profile will be derived from the core FHIR &lt;em&gt;blood pressure&lt;/em&gt; profile and provide additional SNOMED CT codes. This type of profile is called a derived profile, since it is based on another profile. The second example profile does not derive from the core profile but rather will be base on the core FHIR resource &lt;code&gt;observation&lt;/code&gt;. The profile represent a &lt;em&gt;blood pressure&lt;/em&gt; observation, by providing components for diastolic and systolic blood pressure values by slicing the &lt;code&gt;component&lt;/code&gt; element. However in this case, the discriminator will be the value of the &lt;code&gt;code.coding&lt;/code&gt; value. As a result, the code of the e.g. &lt;em&gt;diastolic blood pressure&lt;/em&gt; will be fixed and future implementers cannot add any code when using this profile.&lt;/p&gt;
&lt;p&gt;Both examples will be a StructureDefinition, which is a FHIR resource representing a FHIR profile, in this context a profile to represent blood pressure values.&lt;/p&gt;
&lt;/div&gt;
</content>
      
    </item>
    
    <item>
      <title>Finalizing a Lasso (glmnet) Model: An Example using Credit Data</title>
      <link>/post/2019-01-25-finalizing-glmnet-models/</link>
      <pubDate>Sat, 19 Jan 2019 00:00:00 +0000</pubDate>
      <author>Jens Hüsers</author>
      <guid>/post/2019-01-25-finalizing-glmnet-models/</guid>
      <description></description>
      
      <content>&lt;script src=&#34;//yihui.name/js/math-code.js&#34;&gt;&lt;/script&gt;
&lt;!-- Just one possible MathJax CDN below. You may use others. --&gt;
&lt;script async
  src=&#34;//mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML&#34;&gt;
&lt;/script&gt;
&lt;div id=&#34;evaluating-hyperparameter-with-cross-validation&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Evaluating hyperparameter with Cross Validation&lt;/h1&gt;
&lt;p&gt;In machine learning we develop algorithms to map from predictive variables to an output variable which we wish to predict using unseen data. When building models we can use hyperparameters of the algorithms to increase model performance.&lt;/p&gt;
&lt;p&gt;Lasso regression, which puts a penalty on large model coefficients (see James et al. text book “Introduction to Staticial Learning” for more details), is an example of an algorithm using hyperparameters, to control and find the best amount of shrinkage. Briefly, shrinkage decreases model variance in exchange for some increased model bias, and thus limiting overfitting of a model.&lt;/p&gt;
&lt;p&gt;To figure out the appropriate hyperparameter, in this case the regularization parameter &lt;span class=&#34;math inline&#34;&gt;\(\lambda\)&lt;/span&gt; (lambda), cross-validation is applied. Cross-validation is a method to simulate the model performance by separating all available data into &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; folds, train a model on all but one fold (test fold), where the whitholded fold (test set) is used consecutively to evaluate the models performance using the model which is trained by all other folds. This approach gives us an impression on the model performance on unseen data. In the iterative process of cross-validation, each of the &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; folds serves as the test set, so that we will go through the process of model fitting &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; times. For model evaluation performance metrics are used, e.g. the residual mean squared error (RMSE) in a regression problem. As a result we get &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; test set metrics, which we subsequently average after &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; iterations yielding the final model performance metric.&lt;/p&gt;
&lt;p&gt;This cross-validation process is done for each hyperparameter, in lasso regression it is a set of proposed regularization values &lt;span class=&#34;math inline&#34;&gt;\(\lambda\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;For each proposed hyperparameter, the metric is calculated using the test set, resp. hold-out fold, as described above. The hyperparameter suppling the best metric, e.g. lowest RMSE, is used to create the final model.&lt;/p&gt;
&lt;p&gt;Before doing so, we will conduct model training using the lasso regression to get the best hyperparameter of &lt;span class=&#34;math inline&#34;&gt;\(\lambda\)&lt;/span&gt;. We will use the &lt;code&gt;caret&lt;/code&gt;package to train a model predicting Income using different variable of the &lt;code&gt;ILSL::Credit&lt;/code&gt; dataset, e.g. credit card limit, age and further more.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;data &amp;lt;- ISLR::Credit %&amp;gt;% 
  select(-ID) %&amp;gt;% 
  mutate(random_noise = rnorm(n = nrow(.), sd = 10))

y &amp;lt;- data$Income
# creating a matrix with predictors
X &amp;lt;- model.matrix(Income ~ ., data)

# Setup the training process 
# We will use 10-fold crossvalidation
# Thus, we will get 10 test set metrics which we eventually average to get
# the model performance parameter using a specifi value of lambda

# 10 fold cross validation
# Define training option with trainControl 
tr_ctrl &amp;lt;- caret::trainControl(method = &amp;quot;cv&amp;quot;, number = 5)

# Create a grid of proposed lambda values
# Alpha is set to one, which yields lasso regression
# We use CV to get the appropriate lambda value
hyperparams &amp;lt;- expand.grid(lambda = c(seq(0.1, 4, .1)), alpha = 1)

set.seed(124193)
# Model Training (Metric: Rsquared)
cv_models &amp;lt;- caret::train(x = X,
                          y = y,
                          family = &amp;quot;gaussian&amp;quot;,
                          metric = &amp;quot;RMSE&amp;quot;,
                          method = &amp;quot;glmnet&amp;quot;,
                          trControl = tr_ctrl,
                          tuneGrid = hyperparams)

# Extracting the best hyperparameters (yielded lowest  RMSE)
best_tune &amp;lt;- pluck(cv_models, &amp;quot;bestTune&amp;quot;)


# Plot Regularization Parameter Lambda against RMSE (y-axis)
plot(cv_models)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2019-01-25-finalizing-glmnet-models_files/figure-html/unnamed-chunk-2-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;finalizing-the-model&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Finalizing the model&lt;/h1&gt;
&lt;p&gt;We see in the plot that the cross validated RMSE is lowest when &lt;span class=&#34;math inline&#34;&gt;\(\lambda\)&lt;/span&gt;=0.1, this hyperparameter value should be used in our final model.&lt;/p&gt;
&lt;p&gt;In the next section we will use the &lt;code&gt;glmnet&lt;/code&gt; function from the &lt;code&gt;glmnet&lt;/code&gt; packages which allows us to create a regression model with the specific alpha value.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Setting alpha to 1 yielding lasso regression
# Setting the regularization parameter lambda to best_tune, the value yielding lowest RMSE in the cross-validation procedure
final_model &amp;lt;- glmnet::glmnet(x = X[, -1], y = y, family = &amp;quot;gaussian&amp;quot;, alpha = 1, lambda = best_tune[2])

# Get final model coefficients
broom::tidy(final_model)  %&amp;gt;% 
  select(term, estimate) %&amp;gt;% 
  mutate_at(&amp;quot;estimate&amp;quot;, round, 2) %&amp;gt;% 
  knitr::kable()&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;term&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;estimate&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;(Intercept)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-49.58&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Limit&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.02&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Rating&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.13&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Cards&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.22&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Education&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.12&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;GenderFemale&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.24&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;StudentYes&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;39.88&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;MarriedYes&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.16&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;EthnicityAsian&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.14&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;EthnicityCaucasian&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.17&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Balance&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.09&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;random_noise&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.05&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;coefs &amp;lt;- coef(final_model)

# comuting RSquared value
# predict
y_hat &amp;lt;- matrix(X, ncol = ncol(X)) %*% as.matrix(coefs, nrow = 6)

# R-Squared
r_sq &amp;lt;- 1 - (sum((y_hat[, 1] - y)^2) / sum((y - mean(y))^2))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Following the hyperparameter tuning of lambda, the regularization parameter of the Lasso-Regression we eventually fitted the final model using the hyperparameter lambda which yielded the highest cross-validated R-Squared statistic; In this example the value of lambda was &lt;span class=&#34;math inline&#34;&gt;\(\lambda\)&lt;/span&gt; = 0.1 with a final RMSE value of 10.74, however we do not bother about this value, since we estimated the R-Squared statistic for unseen data using cross-validation, and we except the model to performe as indicated by the cross-validation procedure.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;bottomline&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Bottomline&lt;/h1&gt;
&lt;p&gt;The bottom line of this post is, that we use cross-validation to investigate possible hyperparameters and their performance on unseen data, simulating this scenario by partioning the dataset into folds, withholding a fold and use this fold as the test set.&lt;/p&gt;
&lt;p&gt;We compare the cross-validated metric of each cross-validation process and choose the one with the best metric value, e.g. lowest RMSE.&lt;/p&gt;
&lt;p&gt;We then use all the data in our dataset to fit the final model. This final model will be used to predict future data. In our case our model estimates the income of people with variable such as age, gender and others.&lt;/p&gt;
&lt;/div&gt;
</content>
      
    </item>
    
    <item>
      <title>Koeffizienten des Bass-Models</title>
      <link>/post/estimating-the-bass-model/</link>
      <pubDate>Wed, 07 Nov 2018 00:00:00 +0000</pubDate>
      <author>Jens Hüsers</author>
      <guid>/post/estimating-the-bass-model/</guid>
      <description></description>
      
      <content>&lt;script src=&#34;//yihui.name/js/math-code.js&#34;&gt;&lt;/script&gt;
&lt;script async
src=&#34;//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML&#34;&gt;
&lt;/script&gt;
&lt;div id=&#34;untersuchung-von-innovationen&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Untersuchung von Innovationen&lt;/h1&gt;
&lt;p&gt;Vor dem Hintergrund immer schneller verlaufender Innovationszyklen und der zunehmenden Digitalisierung sind Modelle die versuchen Innovationsmechanismen zu erklären von großem Interesse. Obwohl die Innovationsforschung, die sich mit diesem Thema befasst, heutzutage einen großen Stellenwert einnummt, befassten sich Forscher um 1960 mit der Thematik. Insbesondere Rogers und Bass befassten sich der Erklärung und Modellierung von Innovationen. Bass gelang es als Erster ein mathematisches Model zur Erklärung von Innovationen und der Produktentwicklung zu erstellen, die ursprünglich von Rogers in seiner “Diffusion of Innovation Theory” aufgestellt wurden. Das heute unter dem Namen Bass-Model bekannte statistische Verfahren wurde nach der Publikation der theoretischen Grundlagen durch empirische Daten untermauert.&lt;/p&gt;
&lt;p&gt;In diesem Post möchte ich den Effekt der Modelparameter darstellen, da diese ohne Kontext oftmals schwierig zu verstehen sind.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;modellierung-von-innovationen&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Modellierung von Innovationen&lt;/h1&gt;
&lt;p&gt;Es gibt verschiedene Ansätze dieses Models Innovationen zu betrachten. Ein Ansatz ist, den prozentualen Anteil der Adopter zu modellieren. Im Zentrum des Bass-Models steht der Adopter. Als Adopter werden in diesem Zusammenhang Personen oder Organisationen bezeichnet, die ein neues Produkt nutzen oder innovative technologische Lösungen einsetzten. So kann ein Unternehmen daran interessiert sein, wie hoch der prozentuale Anteil der Nutzer seines neuen Produktes ist.&lt;/p&gt;
&lt;p&gt;Im Rahmen dieser Fragestellung kann dieser Anteil durch das Bass Model geschätzt werden. Das Model basiert dabei auf einer S-förmigen Adoptionskurve die durch folgende Formel dargestellt wird.&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(F(t) = 1 - \frac{e^{-(p + q)t}}{1 + \frac{q}{p}e^{-(p+q)t}}\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Bei diesem Model werden zwei Koeffizienten geschätzt, die bei der Adoption von Innovationen Einfluss üben. Dabei handelt es sich zum eine um den Innovationkoeffizienten p und zum anderen um den Imitationskoeffizienten q.&lt;/p&gt;
&lt;!--
(Ich merke mir diese Zuordnung indem ich mit das in unserer Lesrichtung von links nach rechts schauende p als progressiv und damit innovativ. 
Das zurückblickende q ist der Immitator.)
--&gt;
&lt;p&gt;Diese beiden Koeffizienten erklären, in wie fern Innovatoren und Immitatoren auf die Adoption der Innovation wirken.&lt;/p&gt;
&lt;p&gt;Die Höhe des Innovationskoeffzienten p bestimmt wie stark die stark die Adoption bei der Einführung einer Innovation ist. Je höher der Innovationskoeffizient desto steiller ist die Addoptionskurve zu Beginn. Dass heißt, dass viele Innovatoren ein Produkt adoptieren.&lt;/p&gt;
&lt;p&gt;Die Höhe des Imitationskoeffizienten q erklärt den Einfluss von Imitatoren. Imitatioren orientieren sich dabei an das Verhalten von Adoptern. Der Imitionskoeffizient steht somit in Wechselwirkung mit dem Innovationskoeffizient.&lt;/p&gt;
&lt;p&gt;Während der Innovationskoeffizient p positiv ist, kann der Imitaitonskoeffizient q auch negativ sein. Typische Wert für p liegen im Bereich von null bis zwei. Der q-Wert kann theoretisch große negative Werte annehmen, liegt typischerweise im Bereich von minus ein bis 2. Bei hohen negativen Werten ist kaum Imitaionsverhalten zu erwarten, was sich durch eine flache Adoptionskurve darstellt, nachdem der Innovationseffekt abklingt.&lt;/p&gt;
&lt;p&gt;Ich zur Veranschaulichung des Bass Models die Adoptionskurve verschiedener Parameterkombinationen von p und q visualisiert.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;einfluss-der-modelparameter-p-und-q&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Einfluss der Modelparameter p und q&lt;/h1&gt;
&lt;p&gt;Die Darstellung zeigt Bass-Modelle verschiedener Parameterkombinationen von p und q. Das Model stellt den kumulierten prozentualen Anteil der Adopter dar. Jedes Panel steht dabei für einen Wert von q (Imitaitonskoeffizient) und die Farbe der Linien steht für einen Wert von p (Innovationskoeffzient), wobei mit steigendem Innovationskoeffzienten die Linie heller wird.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(tidyverse)

show_bass_curves &amp;lt;- function(p, q) {
  g &amp;lt;- expand.grid(p, q)
  p_ &amp;lt;- g$Var1
  q_ &amp;lt;- g$Var2
  t &amp;lt;- 0:10
  
  res &amp;lt;- map2(.x = p_, .y = q_, .f = netdiffuseR::bass_F, Time = t) 
  g &amp;lt;- g %&amp;gt;% as.data.frame %&amp;gt;% as.tibble %&amp;gt;% unite(col = &amp;quot;Var&amp;quot;, c(&amp;quot;Var1&amp;quot;, &amp;quot;Var2&amp;quot;)) %&amp;gt;% pull
  
  res &amp;lt;- res %&amp;gt;%
    set_names(g) %&amp;gt;%
    as_tibble() %&amp;gt;% 
    add_column(Time = t) %&amp;gt;% 
    gather(key, value, -Time) %&amp;gt;% 
    separate(col = &amp;quot;key&amp;quot;, into = c(&amp;quot;p&amp;quot;, &amp;quot;q&amp;quot;), sep = &amp;quot;_&amp;quot;) %&amp;gt;% 
    mutate_at(&amp;quot;q&amp;quot;, as.numeric) %&amp;gt;% 
    mutate(q = factor(x = glue::glue(&amp;quot;q = {q}&amp;quot;), 
                      levels = glue::glue(&amp;quot;q = {sort(unique(q))}&amp;quot;),
                      ordered = TRUE))
  
  res %&amp;gt;% 
    ggplot(aes(x = Time, y = value, col = p)) +
    geom_line() +
    facet_wrap(~ as.factor(q), nrow = 2, scales = &amp;quot;free_x&amp;quot;) +
    viridis::scale_color_viridis(discrete = T, option = &amp;quot;magma&amp;quot;) +
    theme_bw() +
    scale_y_continuous(labels = scales::percent, 
                       breaks = seq(0, 1, .2),
                       name = &amp;quot;Proportional Adopters&amp;quot;) +
    scale_x_continuous(breaks = t) +
    guides(colour = guide_legend(reverse=T, title = &amp;quot;p&amp;quot;))
    
}

p &amp;lt;- round(seq(.1, 1, length.out = 8), 2)
q &amp;lt;- round(seq(-1, 1, length.out = 8), 2)

show_bass_curves(p, q)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2018-11-07-estimating-the-bass-model_files/figure-html/unnamed-chunk-1-1.png&#34; width=&#34;768&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Wir erkennen im Diagramm, das ein hoher Innovationskoeffizient die Adoption zu Beginn der Markteinführung positiv beeinflusst. Zudem lässt sich aus dem Diagramm der Einfluss des Imitationseffekts und dessen Interaktion mit dem Innovationskoeffizienten erkennen. Wenn der Innovationskoeffzient hoch ist (Panel links unten), ist auch die Adoption im weitern Zeitverlauf hoch. Sinkt der Imitationskoeffizient hemmt er den weiteren Adoptionsverlauf. Er kann ihn sogar ausbremsen, wenn er negativ wird. In diesem Fall exisitert kein Imitationseffekt und die Innvation ereicht keine vollständige Marktdurchdringung.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;schlussfolgerung&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Schlussfolgerung&lt;/h1&gt;
&lt;p&gt;Das Bass-Model kann eingesetzt werden um den Anteil der kumulierten Adopter bzw. die Adoptionskurve zu modellieren. Das Model besitzt zwei Parameter, nämlich den Innovations- und den Imitationskoeffizienten, die im Bass-Model als p und q bezeichnet werden. Der Innovationskoeffzient p ist unabhängig von q und bestimmt die Steigung der Adoption zu Beginn. Je höher der Koeffizient desto stärker der Effekt der Innovatoren. Der Imitationskoeffizient q interagiert mit p und bestimmt den Verlauf nach der Innovationsphase. Wenn der Imitationseffekt fehlt, also q sehr klein oder negativ ist, fehlen die Imitatoren und die Adoption wird ausgebremst.&lt;/p&gt;
&lt;/div&gt;
</content>
      
    </item>
    
    <item>
      <title>HL7 FHIR Fundamentals - Creating an Observation Resource</title>
      <link>/post/hl7-fhir-fundamentale-create-an-observation-resource/</link>
      <pubDate>Tue, 06 Nov 2018 00:00:00 +0000</pubDate>
      <author>Jens Hüsers</author>
      <guid>/post/hl7-fhir-fundamentale-create-an-observation-resource/</guid>
      <description></description>
      
      <content>&lt;p&gt;In the last post I talked about the central FHIR resource &lt;a href=&#34;https://www.hl7.org/fhir/patient.html&#34;&gt;Patient&lt;/a&gt; which captures all the information of a patient, such as name, date of birth and so forth. Another important resource it &lt;a href=&#34;https://www.hl7.org/fhir/observation.html&#34;&gt;Observation&lt;/a&gt;. This resource is used to give details about a specific observation such as &lt;em&gt;blood pressure&lt;/em&gt; or &lt;em&gt;heart rate&lt;/em&gt;. According to the specification, we use the element &lt;code&gt;code&lt;/code&gt; which has the datatype &lt;a href=&#34;https://www.hl7.org/fhir/datatypes.html#CodeableConcept&#34;&gt;CodeableConcept&lt;/a&gt;. We can use Terminologies like LOINC or SNOMED CT to specifiy the observation type. In the example of my last post about FHIR is observed the width of a wound. So we use the SNOMED CT code &lt;code&gt;401239006&lt;/code&gt; which encodes &lt;em&gt;Width of Wound&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;To record the actual value we use the &lt;code&gt;value&lt;/code&gt; element. More specific we use the &lt;code&gt;valueQuantity&lt;/code&gt; element, since we measured the width in centimeters and the quantity element can capture this information.&lt;/p&gt;
&lt;p&gt;Furthermore I used the &lt;code&gt;subject&lt;/code&gt; element to refer to the patient with the wound. We could actually populate more elements such as &lt;code&gt;bodySite&lt;/code&gt; to record the location of that wound we are talking about. This is especially important when a patient has more than one wound.&lt;/p&gt;
&lt;p&gt;This example shows how we can use FHIR to record the width of a wound. However, in most cases we have multiple observations of one wound, such as width, length or depth of a wound. In this scenario it is not recommented to use an observation resource for each wound characteristic but rather use the &lt;code&gt;component&lt;/code&gt; element of the &lt;em&gt;observation&lt;/em&gt; resource.&lt;/p&gt;
&lt;p&gt;We can use this element to record more than one observation. The &lt;code&gt;component&lt;/code&gt; element has one child for each observation. This child can have the elements &lt;code&gt;code&lt;/code&gt; and &lt;code&gt;value&lt;/code&gt;. Both elements are used as decribed above. The &lt;code&gt;code&lt;/code&gt; tells us what we observed using a code e.g. a SNOMED CT concept. The value tells us the measured or observed value.&lt;/p&gt;
&lt;p&gt;In our use case we observe the length and width of wound. So for each observation we create a child in the &lt;code&gt;component&lt;/code&gt; element. The elements of each child are &lt;code&gt;code&lt;/code&gt; and &lt;code&gt;valueQuantity&lt;/code&gt;. You can see an example below (it is just a subset of the fullresource, though).&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;&amp;quot;component&amp;quot;: [
  {
    &amp;quot;code&amp;quot;: {
      &amp;quot;coding&amp;quot;: [
        {
          &amp;quot;system&amp;quot;: &amp;quot;http://loinc.org&amp;quot;,
          &amp;quot;code&amp;quot;: &amp;quot;39125-0&amp;quot;,
          &amp;quot;display&amp;quot;: &amp;quot;Width of Wound&amp;quot;
        },
        {
          &amp;quot;system&amp;quot;: &amp;quot;http://snomed.info/sct&amp;quot;,
          &amp;quot;code&amp;quot;: &amp;quot;401239006&amp;quot;,
          &amp;quot;display&amp;quot;: &amp;quot;Width of wound&amp;quot;
        }
      ]
    },
    &amp;quot;valueQuantity&amp;quot;: {
      &amp;quot;value&amp;quot;: 4,
      &amp;quot;unit&amp;quot;: &amp;quot;cm&amp;quot;,
      &amp;quot;system&amp;quot;: &amp;quot;http://unitsofmeasure.org&amp;quot;
    }
  },
  {
    &amp;quot;code&amp;quot;: {
      &amp;quot;coding&amp;quot;: [
        {
          &amp;quot;system&amp;quot;: &amp;quot;http://loinc.org&amp;quot;,
          &amp;quot;code&amp;quot;: &amp;quot;39126-8&amp;quot;,
          &amp;quot;display&amp;quot;: &amp;quot;Length of Wound&amp;quot;
        },
        {
          &amp;quot;system&amp;quot;: &amp;quot;http://snomed.info/sct&amp;quot;,
          &amp;quot;code&amp;quot;: &amp;quot;401238003&amp;quot;,
          &amp;quot;display&amp;quot;: &amp;quot;Length of wound&amp;quot;
        }
      ]
    },
    &amp;quot;valueQuantity&amp;quot;: {
      &amp;quot;value&amp;quot;: 3,
      &amp;quot;unit&amp;quot;: &amp;quot;cm&amp;quot;,
      &amp;quot;system&amp;quot;: &amp;quot;http://unitsofmeasure.org&amp;quot;
    }
  }
]
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;So in this example we use the &lt;code&gt;component&lt;/code&gt; element instead of the direct &lt;code&gt;code&lt;/code&gt; and &lt;code&gt;value&lt;/code&gt; elements of the &lt;a href=&#34;https://www.hl7.org/fhir/observation.html&#34;&gt;Observation&lt;/a&gt; resource as we did in the first example where we recorded just one observation namely the width of a wound. However, we can use both elements to state that this observation is actually about a wound. So in my example I use the &lt;code&gt;code&lt;/code&gt; element with the SNOMED CT code &lt;code&gt;95344007&lt;/code&gt; which encodes the concept of a ulcer of lower extremity. You can see an example of this element below. It now refers to the wound being examed. We can furthermore specify the location of the wound using the &lt;code&gt;bodySite&lt;/code&gt; element.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;&amp;quot;code&amp;quot;: {
  &amp;quot;coding&amp;quot;: [
    {
      &amp;quot;system&amp;quot;: &amp;quot;http://snomed.info/sct&amp;quot;,
      &amp;quot;code&amp;quot;: &amp;quot;95344007&amp;quot;,
      &amp;quot;display&amp;quot;: &amp;quot;Ulcer of lower extemity&amp;quot;
    }
  ]
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This observation records what a practitioner has examed in the &lt;code&gt;code&lt;/code&gt; element and lists all observations in the &lt;code&gt;component&lt;/code&gt; element. To complete the resource I populated the &lt;code&gt;subject&lt;/code&gt; and &lt;code&gt;performer&lt;/code&gt; elements by referting to a patient resp. to a practitioner. I post the resource to a public FHIR server. You can find the resource in the appendix or get it by using the following query:&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://fhirtest.uhn.ca/baseDstu3/Observation?_id=429259&#34; class=&#34;uri&#34;&gt;http://fhirtest.uhn.ca/baseDstu3/Observation?_id=429259&lt;/a&gt;&lt;/p&gt;
&lt;div id=&#34;appendix&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Appendix&lt;/h1&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;{
  &amp;quot;fullUrl&amp;quot;: &amp;quot;http://hapi.fhir.org/baseDstu3/Observation/429259&amp;quot;,
  &amp;quot;resource&amp;quot;: {
    &amp;quot;resourceType&amp;quot;: &amp;quot;Observation&amp;quot;,
    &amp;quot;id&amp;quot;: &amp;quot;429259&amp;quot;,
    &amp;quot;meta&amp;quot;: {
      &amp;quot;versionId&amp;quot;: &amp;quot;1&amp;quot;,
      &amp;quot;lastUpdated&amp;quot;: &amp;quot;2018-11-06T00:09:39.201+00:00&amp;quot;
    },
    &amp;quot;status&amp;quot;: &amp;quot;final&amp;quot;,
    &amp;quot;category&amp;quot;: [
      {
        &amp;quot;coding&amp;quot;: [
          {
            &amp;quot;system&amp;quot;: &amp;quot;http://hl7.org/fhir/observation-category&amp;quot;,
            &amp;quot;code&amp;quot;: &amp;quot;exam&amp;quot;,
            &amp;quot;display&amp;quot;: &amp;quot;Exam&amp;quot;
          }
        ]
      }
    ],
    &amp;quot;code&amp;quot;: {
      &amp;quot;coding&amp;quot;: [
        {
          &amp;quot;system&amp;quot;: &amp;quot;http://snomed.info/sct&amp;quot;,
          &amp;quot;code&amp;quot;: &amp;quot;95344007&amp;quot;,
          &amp;quot;display&amp;quot;: &amp;quot;Ulcer of lower extemity&amp;quot;
        }
      ]
    },
    &amp;quot;subject&amp;quot;: {
      &amp;quot;reference&amp;quot;: &amp;quot;Patient/428166&amp;quot;
    },
    &amp;quot;performer&amp;quot;: [
      {
        &amp;quot;reference&amp;quot;: &amp;quot;Practitioner/22694&amp;quot;
      }
    ],
    &amp;quot;bodySite&amp;quot;: {
      &amp;quot;coding&amp;quot;: [
        {
          &amp;quot;system&amp;quot;: &amp;quot;http://snomed.info/sct&amp;quot;,
          &amp;quot;code&amp;quot;: &amp;quot;723607002&amp;quot;,
          &amp;quot;display&amp;quot;: &amp;quot;Structure of right heel&amp;quot;
        }
      ]
    },
    &amp;quot;component&amp;quot;: [
      {
        &amp;quot;code&amp;quot;: {
          &amp;quot;coding&amp;quot;: [
            {
              &amp;quot;system&amp;quot;: &amp;quot;http://loinc.org&amp;quot;,
              &amp;quot;code&amp;quot;: &amp;quot;39125-0&amp;quot;,
              &amp;quot;display&amp;quot;: &amp;quot;Width of Wound&amp;quot;
            },
            {
              &amp;quot;system&amp;quot;: &amp;quot;http://snomed.info/sct&amp;quot;,
              &amp;quot;code&amp;quot;: &amp;quot;401239006&amp;quot;,
              &amp;quot;display&amp;quot;: &amp;quot;Width of wound&amp;quot;
            }
          ]
        },
        &amp;quot;valueQuantity&amp;quot;: {
          &amp;quot;value&amp;quot;: 4,
          &amp;quot;unit&amp;quot;: &amp;quot;cm&amp;quot;,
          &amp;quot;system&amp;quot;: &amp;quot;http://unitsofmeasure.org&amp;quot;
        }
      },
      {
        &amp;quot;code&amp;quot;: {
          &amp;quot;coding&amp;quot;: [
            {
              &amp;quot;system&amp;quot;: &amp;quot;http://loinc.org&amp;quot;,
              &amp;quot;code&amp;quot;: &amp;quot;39126-8&amp;quot;,
              &amp;quot;display&amp;quot;: &amp;quot;Length of Wound&amp;quot;
            },
            {
              &amp;quot;system&amp;quot;: &amp;quot;http://snomed.info/sct&amp;quot;,
              &amp;quot;code&amp;quot;: &amp;quot;401238003&amp;quot;,
              &amp;quot;display&amp;quot;: &amp;quot;Length of wound&amp;quot;
            }
          ]
        },
        &amp;quot;valueQuantity&amp;quot;: {
          &amp;quot;value&amp;quot;: 3,
          &amp;quot;unit&amp;quot;: &amp;quot;cm&amp;quot;,
          &amp;quot;system&amp;quot;: &amp;quot;http://unitsofmeasure.org&amp;quot;
        }
      }
    ]
  }
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
</content>
      
    </item>
    
    <item>
      <title>HL7 FHIR Fundamentals - Creating Resources</title>
      <link>/post/hl-fhir-fundamentale-creating-resources/</link>
      <pubDate>Mon, 05 Nov 2018 00:00:00 +0000</pubDate>
      <author>Jens Hüsers</author>
      <guid>/post/hl-fhir-fundamentale-creating-resources/</guid>
      <description></description>
      
      <content>&lt;div id=&#34;fhir-fundamentals-class&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;FHIR Fundamentals Class&lt;/h1&gt;
&lt;p&gt;On November 1st 2018 I started an online course on the HL7 FHIR Standard. This course is offerd by the HL7 which is an international organization for standardization in healthcare and it is all about the latest standard called Fast Healthcare Interoperablity Resources or short: FHIR.&lt;/p&gt;
&lt;p&gt;This standard used RESTful services and json or xml-documents to transfer information.&lt;/p&gt;
&lt;p&gt;As the name FHIR suggests this standard is all about resources which are the main building blocks in FHIR to capture information. Right now there are more than 100 resources and an example it the patient resource which is one of the most common resources. So this resource is used to capture information about a patient such as family name, given name, contact information or date of birth.&lt;/p&gt;
&lt;p&gt;In this course we were asked to create a patient resource on our own. You can see the results in the appendix of this post. As you can see, FHIR used single elements which represent key value pairs to capture information. This elements capture the information about family name and so forth.&lt;/p&gt;
&lt;p&gt;As we currently working on a digital document for wound care I was curious how to capture information about a wound of a patient. We can use the FHIR resource observation which is able to capture information about wounds. To accomplish this, we can use terminology codes, e.g. SNOMED CT or LOINC, to state what the observation resource captures in connection with an actual value.&lt;/p&gt;
&lt;p&gt;In this example I wanted to capture the with of a wound. So we use the SNOMED CT concept “401239006” wich is the “Width of Wound”. We use the data element code to express the kind of observation. The actual value of the “Width of Wound” is stored in the “value” element. This element can capture the value in many ways but in this use case we use the element valueQuantity to represent the Width of Wound in centimeters.&lt;/p&gt;
&lt;p&gt;Most important we can use the element subject to refer to the patient with the wound. The data type of this element is called reference since it refers to the Patient. In my example the subject of this observation is my patient resource.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;using-fhir-servers&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Using FHIR Servers&lt;/h1&gt;
&lt;p&gt;I used public available FHIR servers to upload my resources. Since they are public and the servers offer RESTful queries you can query them as well.&lt;/p&gt;
&lt;p&gt;To get my patient information you can use the lastname, given name or the id of the resource which is &lt;code&gt;428166&lt;/code&gt;:&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://fhirtest.uhn.ca/baseDstu3/Patient?_id=428166&#34; class=&#34;uri&#34;&gt;http://fhirtest.uhn.ca/baseDstu3/Patient?_id=428166&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;To get all the observations of this patients, you can use the id of the patient resource.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://fhirtest.uhn.ca/baseDstu3/Observation?patient=428166&#34; class=&#34;uri&#34;&gt;http://fhirtest.uhn.ca/baseDstu3/Observation?patient=428166&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;appendix&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Appendix&lt;/h1&gt;
&lt;div id=&#34;patient-resource&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Patient Resource&lt;/h2&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;{
  &amp;quot;resourceType&amp;quot;: &amp;quot;Patient&amp;quot;,
  &amp;quot;id&amp;quot;: &amp;quot;428166&amp;quot;,
  &amp;quot;meta&amp;quot;: {
    &amp;quot;versionId&amp;quot;: &amp;quot;1&amp;quot;,
    &amp;quot;lastUpdated&amp;quot;: &amp;quot;2018-11-05T18:20:43.793+00:00&amp;quot;
  },
  &amp;quot;text&amp;quot;: {
    &amp;quot;status&amp;quot;: &amp;quot;generated&amp;quot;,
    &amp;quot;div&amp;quot;: &amp;quot;&amp;lt;div xmlns=\&amp;quot;http://www.w3.org/1999/xhtml\&amp;quot;&amp;gt;&amp;lt;div class=\&amp;quot;hapiHeaderText\&amp;quot;&amp;gt;Jens &amp;lt;b&amp;gt;HÜSERS &amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;table class=\&amp;quot;hapiPropertyTable\&amp;quot;&amp;gt;&amp;lt;tbody&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;Address&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;span&amp;gt;3300 Washtenaw &amp;lt;/span&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;span&amp;gt;Ann Harbor &amp;lt;/span&amp;gt;&amp;lt;span&amp;gt;MI &amp;lt;/span&amp;gt;&amp;lt;span&amp;gt;US &amp;lt;/span&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;Date of birth&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;span&amp;gt;25 June 1987&amp;lt;/span&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/tbody&amp;gt;&amp;lt;/table&amp;gt;&amp;lt;/div&amp;gt;&amp;quot;
  },
  &amp;quot;name&amp;quot;: [
    {
      &amp;quot;use&amp;quot;: &amp;quot;official&amp;quot;,
      &amp;quot;family&amp;quot;: &amp;quot;Hüsers&amp;quot;,
      &amp;quot;given&amp;quot;: [
        &amp;quot;Jens&amp;quot;
        ]
    }
    ],
  &amp;quot;telecom&amp;quot;: [
    {
      &amp;quot;value&amp;quot;: &amp;quot;(03) 5555 67889&amp;quot;,
      &amp;quot;use&amp;quot;: &amp;quot;home&amp;quot;
    }
    ],
  &amp;quot;gender&amp;quot;: &amp;quot;male&amp;quot;,
  &amp;quot;birthDate&amp;quot;: &amp;quot;1987-06-25&amp;quot;,
  &amp;quot;address&amp;quot;: [
    {
      &amp;quot;line&amp;quot;: [
        &amp;quot;3300 Washtenaw&amp;quot;
        ],
      &amp;quot;city&amp;quot;: &amp;quot;Ann Harbor&amp;quot;,
      &amp;quot;district&amp;quot;: &amp;quot;Washtenaw&amp;quot;,
      &amp;quot;state&amp;quot;: &amp;quot;MI&amp;quot;,
      &amp;quot;postalCode&amp;quot;: &amp;quot;48104&amp;quot;,
      &amp;quot;country&amp;quot;: &amp;quot;US&amp;quot;
    }
    ]
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;observation-resource&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Observation Resource&lt;/h2&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;{
        &amp;quot;resourceType&amp;quot;: &amp;quot;Observation&amp;quot;,
        &amp;quot;id&amp;quot;: &amp;quot;428168&amp;quot;,
        &amp;quot;meta&amp;quot;: {
          &amp;quot;versionId&amp;quot;: &amp;quot;1&amp;quot;,
          &amp;quot;lastUpdated&amp;quot;: &amp;quot;2018-11-05T18:24:48.370+00:00&amp;quot;
        },
        &amp;quot;status&amp;quot;: &amp;quot;final&amp;quot;,
        &amp;quot;category&amp;quot;: [
          {
            &amp;quot;coding&amp;quot;: [
              {
                &amp;quot;system&amp;quot;: &amp;quot;http://hl7.org/fhir/observation-category&amp;quot;,
                &amp;quot;code&amp;quot;: &amp;quot;exam&amp;quot;,
                &amp;quot;display&amp;quot;: &amp;quot;Exam&amp;quot;
              }
            ]
          }
        ],
        &amp;quot;code&amp;quot;: {
          &amp;quot;coding&amp;quot;: [
            {
              &amp;quot;system&amp;quot;: &amp;quot;http://snomed.info/sct&amp;quot;,
              &amp;quot;code&amp;quot;: &amp;quot;401239006&amp;quot;,
              &amp;quot;display&amp;quot;: &amp;quot;Width of wound&amp;quot;
            },
            {
              &amp;quot;system&amp;quot;: &amp;quot;http://loinc.org&amp;quot;,
              &amp;quot;code&amp;quot;: &amp;quot;39125-0&amp;quot;,
              &amp;quot;display&amp;quot;: &amp;quot;Width of Wound&amp;quot;
            }
          ]
        },
        &amp;quot;subject&amp;quot;: {
          &amp;quot;reference&amp;quot;: &amp;quot;Patient/428166&amp;quot;
        },
        &amp;quot;valueQuantity&amp;quot;: {
          &amp;quot;value&amp;quot;: 4,
          &amp;quot;unit&amp;quot;: &amp;quot;cm&amp;quot;,
          &amp;quot;system&amp;quot;: &amp;quot;http://unitsofmeasure.org&amp;quot;
        }
      },
      &amp;quot;search&amp;quot;: {
        &amp;quot;mode&amp;quot;: &amp;quot;match&amp;quot;
      }
    }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
</content>
      
    </item>
    
    <item>
      <title>Exploring the Cost Function of Logistic Regression</title>
      <link>/post/exploring-the-cost-function-of-logistic-regression/</link>
      <pubDate>Sun, 14 Oct 2018 00:00:00 +0000</pubDate>
      <author>Jens Hüsers</author>
      <guid>/post/exploring-the-cost-function-of-logistic-regression/</guid>
      <description></description>
      
      <content>&lt;script src=&#34;//yihui.name/js/math-code.js&#34;&gt;&lt;/script&gt;
&lt;!-- Just one possible MathJax CDN below. You may use others. --&gt;
&lt;script async
  src=&#34;//mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML&#34;&gt;
&lt;/script&gt;
&lt;p&gt;This post is about exploring the cost function and its connection to the logistic regression function.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;knitr::opts_chunk$set(echo = TRUE, warning=F, message=FALSE, fig.align=&amp;#39;center&amp;#39;)
library(tidyverse)
library(plotly)
library(latex2exp)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I want to get a deeper understanding of the connection between the logistic regresssion and its cost function. Therefore I created a function in R and conducted a grid approximation with this function. The results are presented below.&lt;/p&gt;
&lt;p&gt;The logistic regression can be applied to data where the dependent variable is coded binary where the referent class is coded as a 1 and as 0 otherwise. We can model the relationship of this binary outcome variable with metric and categorical predictor variables. As a result, we can then compute the predicted probability that a datapoint is a member of the referent class coded as 1.&lt;/p&gt;
&lt;p&gt;The logistic regression model with an intercept and one depentent variable is as follows:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[\log(\frac{p(x)}{1 - p(x)}) = \beta_0 + \beta_1x_i\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;This formula models the Logarithm of the Odds-Ratio. This is the logistic regression model with an intercept and one predictor variable. To find the &lt;span class=&#34;math inline&#34;&gt;\(\beta\)&lt;/span&gt;-Coefficients that fit the data best we optimize the following cost-function, the Log-Likelihood function.&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[Cost(p(x), y) = \frac{1}{n}\sum{-y_i \log(p(x_i) - (1 - y_i)\log(p(x_i)))}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Since the linear equation of logistic regression predicts the Logit, this equation can be rearranged to get a prediction of &lt;span class=&#34;math inline&#34;&gt;\(p(x)\)&lt;/span&gt; which is basically the probability that a observation belongs to the reference group:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[p(x) = \frac{1}{(1 + e^{-(\beta_0 + \beta_1x_i)})}\]&lt;/span&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Logistic function to predict p(x)
logistic_function &amp;lt;- function(D, b) {
  1 / (1 + (1 / exp(D %*% b)))
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We can then create the cost function and put the logistic-function in the cost-function.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Cost function for logistic regression
logistic_cost &amp;lt;- function(y, D, b){
  y_hat &amp;lt;- logistic_function(D, b)
  1/length(y_hat) * sum(-y * -log(y_hat) - (1 - y) * -log((1 - y_hat)))
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;To conduct the grid approximation, I write another function that takes the grid containing parameters, the predictor matrix and the outcome variable y as arguments and them computes the cost for every parameter combination. The function returns a matrix containing the grid and the corresponding cost.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Compute the cost for different combinations of regression weights
# Returns the costs in a vector
grid_approx_logistic &amp;lt;- function(grid, data, outcome) {
  cost &amp;lt;- NULL
  for(i in seq(nrow(grid))) {
    betas &amp;lt;- as.numeric(grid[i, ])
    betas &amp;lt;- create_weight_matrix(betas)
    cost[i] &amp;lt;- logistic_cost(y = outcome, D = data, b = betas)    
  }
  cost_grid &amp;lt;- as.matrix(cbind(grid, cost))
  return(cost_grid)
}

# Create helper function to construct the weight matrix given a vector with proposed weights
# Used in the grid_approx_logistic function
create_weight_matrix &amp;lt;- function(weights) {
  betas &amp;lt;- matrix(weights, nrow = length(weights))
  return(betas)
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I will use the &lt;code&gt;mtcars&lt;/code&gt; dataset and I choose to model the probability beeing an automatic car as a function of miles per hour. First I set the grid with plausible values (I got them from running the glm function in the first place).&lt;/p&gt;
&lt;p&gt;After that I create the predictor matrix, containing the intercept and the &lt;code&gt;mpg&lt;/code&gt; data, and subset the variable &lt;code&gt;am&lt;/code&gt; as outcome &lt;span class=&#34;math inline&#34;&gt;\(y\)&lt;/span&gt;.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# create grid
grid &amp;lt;- expand.grid(seq(-20, 0, length.out = 50), seq(0, 1, length.out = 50))

# set intercept
mtcars$intercept &amp;lt;- 1
# subset prediction matrix
data &amp;lt;- as.matrix(mtcars[, c(&amp;quot;intercept&amp;quot;, &amp;quot;mpg&amp;quot;)])
# subset dependent variable
y &amp;lt;- mtcars$am&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Next I run the &lt;code&gt;grid_approx_logistic&lt;/code&gt; function which computes the cost for every combination.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# compute cost for each parameter combination
cost &amp;lt;- grid_approx_logistic(grid = grid, data = data, outcome = y)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I visulize the result with a combination of a raster and contour plot to visualize the parameter combination with the hightes likelihood.&lt;/p&gt;
&lt;p&gt;Furthermore I added the regression weights computed by the &lt;code&gt;glm&lt;/code&gt; function.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# compute the logistic regression with base r function glm
model &amp;lt;- glm(am ~ mpg, family = &amp;quot;binomial&amp;quot;, data = mtcars)  
coefs &amp;lt;- as.data.frame(map(coef(model), list)) %&amp;gt;% set_names(c(&amp;quot;beta0&amp;quot;, &amp;quot;beta1&amp;quot;))

# visualize the regession combinations vs the computed cost
as.data.frame(cost) %&amp;gt;% 
  ggplot(aes(x = Var1, y = Var2, z = cost, color = cost, fill = cost)) +
  geom_raster(interpolate = FALSE) +
  geom_contour(bins = 30) + 
  geom_point(data = coefs, aes(x = beta0, y = beta1), size = 4, color = &amp;quot;white&amp;quot;, inherit.aes = F) +
  geom_label(data = coefs, aes(x = beta0, y = beta1), 
             label = TeX(&amp;quot;$\\beta_0, \\beta_1 = (-6.6, 0.3)$&amp;quot;),
             inherit.aes = F,
             nudge_x = 1, nudge_y = .05, size = 5) +
  theme_classic() +
  scale_fill_continuous(&amp;quot;Cost-Function&amp;quot;) +
  scale_color_continuous(&amp;quot;Cost-Function&amp;quot;) +
  xlab(TeX(&amp;quot;$\\beta_0$ (Intercept)&amp;quot;)) +
  ylab(TeX(&amp;quot;$\\beta_1$ (Regressionsgewicht für Miles per Hour)&amp;quot;)) +
  ggtitle(&amp;quot;Maximizing the negative Log-Likelihood Function&amp;quot;, sub = &amp;quot;Grid Approximation&amp;quot;) +
  theme(text = element_text(family = &amp;quot;Times&amp;quot;),
        title = element_text(size = 14), 
        axis.text = element_text(size = 12))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2018-10-14-exploring-the-cost-function-of-logistic-regression_files/figure-html/visualize-ml-1.png&#34; width=&#34;960&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;We can see that the area with the hightest density, resp highest likelihood, correspondes with the computed coefficents.&lt;/p&gt;
&lt;p&gt;However, we can also see, that there is a area corresponding to low values of the cost function which maybe leads to unstable estimates of the regression coeficients.&lt;/p&gt;
&lt;p&gt;Since I started with a grid that mirrors the result of the glm function, grid approximation is often a bad approach to find the best parameter combination of a logistic model.&lt;/p&gt;
&lt;p&gt;Other approaches use the gradient decent algorithm, which is computational much cheaper and therefore faster.&lt;/p&gt;
</content>
      
    </item>
    
    <item>
      <title>GMDS Tutorium 2018 - Datenvisualisierung in R mit ggplot2</title>
      <link>/post/gmds-tutorium-2018-datenvisualisierung-in-r-mit-ggplot2/</link>
      <pubDate>Thu, 06 Sep 2018 00:00:00 +0000</pubDate>
      <author>Jens Hüsers</author>
      <guid>/post/gmds-tutorium-2018-datenvisualisierung-in-r-mit-ggplot2/</guid>
      <description>Workbook of my tutorial on ‘Data Visualisation in R with ggplot2’ at the 63rd Annual Conference of the GMDS e.V. on Sep. 6th 2018 in Osnabrück.</description>
      
      <content>&lt;p&gt;Dieses Dokument enthält die Aufgaben zu meinem Tutorial “Datenvisualisierung in R mit ggplot2” auf der 63. Jahrestagung der GMDS am 6. September 2018 in Osnabrück.&lt;/p&gt;
&lt;p&gt;Die Präsentation zum Workshop sind &lt;a href=&#34;https://jnshsrs.github.io/gmds18-tutorium-ggplot2/slides-ggplot-gmds18.html&#34; title=&#34;Slides des Tutoriums&#34;&gt;hier&lt;/a&gt; zu finden. Das Repository mit den Dateien sind &lt;a href=&#34;github.com/jnshsrs/gmds18-tutorium-ggplot2&#34;&gt;hier&lt;/a&gt; zu finden.&lt;/p&gt;
&lt;div align=&#34;center&#34;&gt;
&lt;iframe src=&#34;https://jnshsrs.github.io/gmds18-tutorium-ggplot2/slides-ggplot-gmds18.html&#34; width=&#34;720&#34; height=&#34;450&amp;quot;&#34;&gt;
&lt;/iframe&gt;
&lt;/div&gt;
&lt;div id=&#34;setup&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Setup&lt;/h1&gt;
&lt;p&gt;Laden der benötigten R-Pakete für dieses Tutorium.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# laden von ggplot2
library(ggplot2)

# Wir können ggplot2 auch mit dem tidyverse Paket laden
# In dem Fall werden weitere Pakete des wie z.B. dplyr geladen
library(tidyverse)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Im folgenden werden die wichtigsten und populärsten Typen in der wissenschaftlichen Datenanalyse vorgestellt und Übungen zu deren Erstellung vorgeschlagen.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;scatterplot&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Scatterplot&lt;/h1&gt;
&lt;div class=&#34;task&#34;&gt;
&lt;p&gt;&lt;strong&gt;Aufgabe&lt;/strong&gt;&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;p&gt;Nutzen Sie dazu die Daten des &lt;code&gt;titanic&lt;/code&gt;- Datensatzes. Laden Sie zunächst den Datensatz mit der Funktion &lt;code&gt;read_csv&lt;/code&gt; und speichern sie diesen im einem Objekt mit dem Namen &lt;code&gt;titanic&lt;/code&gt;. Die Daten liegen im &lt;code&gt;csv&lt;/code&gt;-Format vor und sind im Ordner &lt;code&gt;data/titanic.csv&lt;/code&gt; gespeichert.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Geben Sie die ersten 6 Zeilen des Datensatzes aus.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Erstellen Sie einen Scatterplot mit &lt;code&gt;ggplot2&lt;/code&gt;. Nutzen Sie dazu als Daten den &lt;code&gt;titanic&lt;/code&gt;-Datensatz. Verknüpfen (mappen) Sie die Variable &lt;code&gt;age&lt;/code&gt; mit der x-Achse und &lt;code&gt;fare&lt;/code&gt; mit der y-Achse (Aesthetics). Nutzen sie als Geom &lt;code&gt;geom_point&lt;/code&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Verknüpfen Sie die Farbe der Punkte mit der Klasse des Passagiers&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# laden der Titanic Daten
titanic &amp;lt;- read_csv(&amp;quot;data/titanic.csv&amp;quot;)

# Anzeigen der ersten 6 Zeilen des Datensatzes
head(titanic)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 6 x 14
##   pclass survived name  sex     age sibsp parch ticket  fare cabin embarked
##    &amp;lt;dbl&amp;gt;    &amp;lt;dbl&amp;gt; &amp;lt;chr&amp;gt; &amp;lt;chr&amp;gt; &amp;lt;dbl&amp;gt; &amp;lt;dbl&amp;gt; &amp;lt;dbl&amp;gt; &amp;lt;chr&amp;gt;  &amp;lt;dbl&amp;gt; &amp;lt;chr&amp;gt; &amp;lt;chr&amp;gt;   
## 1      1        1 Alle… fema… 29        0     0 24160  211.  B5    S       
## 2      1        1 Alli… male   0.92     1     2 113781 152.  C22 … S       
## 3      1        0 Alli… fema…  2        1     2 113781 152.  C22 … S       
## 4      1        0 Alli… male  30        1     2 113781 152.  C22 … S       
## 5      1        0 Alli… fema… 25        1     2 113781 152.  C22 … S       
## 6      1        1 Ande… male  48        0     0 19952   26.6 E12   S       
## # … with 3 more variables: boat &amp;lt;dbl&amp;gt;, body &amp;lt;dbl&amp;gt;, home.dest &amp;lt;chr&amp;gt;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ggplot(data = titanic, 
       mapping = aes(x = age, y = fare, col = pclass)) + 
  geom_point() &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2018-09-06-gmds-tutorium-2018-datenvisualisierung-in-r-mit-ggplot2_files/figure-html/scatter-plot-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Tipp: Die jeweiligen geometischen Element wie z.B. &lt;code&gt;geom_point&lt;/code&gt; und &lt;code&gt;geom_histogram&lt;/code&gt; können bestimmte aestetische Elemente verstehten. Das geometrisch Element &lt;code&gt;geom_point&lt;/code&gt; kann aestetische Elemente wie &lt;code&gt;x&lt;/code&gt;, &lt;code&gt;y&lt;/code&gt; sowie &lt;code&gt;color&lt;/code&gt;, &lt;code&gt;size&lt;/code&gt; und weitere Verknüpfungen verarbeiten.&lt;/p&gt;
&lt;p&gt;Einige geometrische Elemente sind zwingend erforderlich. Beim geometrischen Element &lt;code&gt;geom_point&lt;/code&gt; sind die &lt;code&gt;x&lt;/code&gt; und &lt;code&gt;y&lt;/code&gt; Achse erforderlich, alle weitern optional.&lt;/p&gt;
&lt;p&gt;Eine Übersicht über die aesterischen Elemente, die ein geometrisches Element versteht, kann in der Dokumentation der jeweiligen Geome eingesehen werden. In der R-Konsole kann die Dokumentation mit folgdendem Code aufgerufen werden: &lt;code&gt;?geom_point&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;task&#34;&gt;
&lt;p&gt;&lt;strong&gt;Aufgabe&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Erstellen Sie erneut ein Punktdiagramm, wie oben beschrieben jedoch ohne die &lt;code&gt;color&lt;/code&gt; zu verknüpfen. Fügen Sie nun zusätzlich das geometrische Element &lt;code&gt;geom_smooth&lt;/code&gt; hinzu und spezifizieren sie das Funktionsargument wie folgt: &lt;code&gt;method = &amp;quot;lm&amp;quot;&lt;/code&gt; um den bivariaten, linearen Trend zwischen dem Alter und dem Fahrpreis zu visualisieren.&lt;/p&gt;
&lt;p&gt;Besteht ein Zusammenhang zwischen diesen beiden Variablen?&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ggplot(data = titanic,
       mapping = aes(x = age, y = fare)
       ) +
  geom_point() +
  geom_smooth(method = &amp;quot;lm&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2018-09-06-gmds-tutorium-2018-datenvisualisierung-in-r-mit-ggplot2_files/figure-html/unnamed-chunk-1-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;barplots&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Barplots&lt;/h1&gt;
&lt;div class=&#34;task&#34;&gt;
&lt;p&gt;&lt;strong&gt;Aufgabe&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Erstellen Sie ein Balkendiagramm. Diese soll die Anzahl der Passagiere in den jeweiligen Klassen darstellen. Zusätzlich soll die Anzahl der Überlebende farblich dargestellt werden.&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Erstellen Sie ein entprechendes Balkendiagramm mit ggplot2 in dem sie die x-Achse mit der entsprechenden Variablen verknüpfen.&lt;/li&gt;
&lt;li&gt;Verknüpfen Sie die ‘fill-aesthetic’ mit der Variable &lt;code&gt;survived&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Nutzen sie den Funktionsparameter &lt;code&gt;position&lt;/code&gt; der Funktion &lt;code&gt;geom_bar&lt;/code&gt; und setzten ihn auf &lt;code&gt;&amp;quot;fill&amp;quot;&lt;/code&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Was ist der Unterschied zwischen beiden Grafiken? Welche Vor- und Nachteile entstehten durch den Einsatz der Option &lt;code&gt;&amp;quot;fill&amp;quot;&lt;/code&gt;?&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ggplot(data = titanic, 
       mapping = aes(x = pclass, fill = survived)) +
  geom_bar()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2018-09-06-gmds-tutorium-2018-datenvisualisierung-in-r-mit-ggplot2_files/figure-html/unnamed-chunk-2-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ggplot(data = titanic, 
       mapping = aes(x = pclass, fill = survived)) +
  geom_bar(position = &amp;quot;fill&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2018-09-06-gmds-tutorium-2018-datenvisualisierung-in-r-mit-ggplot2_files/figure-html/unnamed-chunk-3-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;boxplots&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Boxplots&lt;/h1&gt;
&lt;div class=&#34;task&#34;&gt;
&lt;p&gt;&lt;strong&gt;Aufgabe&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Stellen Sie die Verteilung des Preises für die jeweiligen Passagierklassen dar. Nutzen Sie dafür Boxplots.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ggplot(data = titanic, 
       mapping = aes(x = pclass, y = fare)) +
  geom_boxplot() &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2018-09-06-gmds-tutorium-2018-datenvisualisierung-in-r-mit-ggplot2_files/figure-html/unnamed-chunk-4-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;histogramme&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Histogramme&lt;/h1&gt;
&lt;div class=&#34;task&#34;&gt;
&lt;p&gt;&lt;strong&gt;Aufgabe&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Erstelle ein Histogramm um die Verteilung der Variablen &lt;code&gt;age&lt;/code&gt; darzustellen. Experimentieren mit den Funktionsparameter &lt;code&gt;bins&lt;/code&gt;, der die Anzahl der Balken des Diagramms definiert.&lt;/p&gt;
&lt;p&gt;Um die Balkenfarbe zu ändern setze den Parameter &lt;code&gt;fill=&amp;quot;darkgrey&amp;quot;&lt;/code&gt; direkt in der Funktion &lt;code&gt;geom_histogram&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Zusätzlich füge die Funktion &lt;code&gt;theme_minimal()&lt;/code&gt; dem Plot hinzu um das Aussehen des Histogramms zu ändern.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ggplot(data = titanic,
       mapping = aes(x = age)) +
  geom_histogram(bins = 20, fill = &amp;quot;darkgrey&amp;quot;) +
  theme_minimal()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2018-09-06-gmds-tutorium-2018-datenvisualisierung-in-r-mit-ggplot2_files/figure-html/unnamed-chunk-5-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;exkurs&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Exkurs&lt;/h1&gt;
&lt;div id=&#34;statistische-berechnungen-mit-ggplot2&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Statistische Berechnungen mit ggplot2&lt;/h2&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ggplot(data = titanic,
       mapping = aes(x = sex, y = fare)) +
  stat_summary(fun.data = &amp;quot;mean_se&amp;quot;, geom = &amp;quot;errorbar&amp;quot;, width = .2)  +
  stat_summary(fun.y = &amp;quot;mean&amp;quot;, geom = &amp;quot;point&amp;quot;)  +
  facet_grid(~pclass)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2018-09-06-gmds-tutorium-2018-datenvisualisierung-in-r-mit-ggplot2_files/figure-html/unnamed-chunk-6-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;publication-ready-plots&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Publication Ready Plots&lt;/h1&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;MASS::mammals %&amp;gt;% 
  ggplot(aes(x = body, y = brain)) +
  geom_point(alpha = 0.6) +
  stat_smooth(method = &amp;quot;lm&amp;quot;, col = &amp;quot;red&amp;quot;, se = FALSE)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2018-09-06-gmds-tutorium-2018-datenvisualisierung-in-r-mit-ggplot2_files/figure-html/unnamed-chunk-7-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(scales)

MASS::mammals %&amp;gt;% 
  ggplot(aes(x = body, y = brain)) +
  geom_point(alpha = .6) +
  geom_smooth(method = &amp;quot;lm&amp;quot;, se = FALSE, col = &amp;quot;red&amp;quot;) +
  scale_x_log10(expression(&amp;quot;Body weight (log&amp;quot;[&amp;quot;10&amp;quot;]*&amp;quot;(Kg))&amp;quot;),
                breaks = trans_breaks(&amp;quot;log10&amp;quot;, function(x) 10^x),
                labels = trans_format(&amp;quot;log10&amp;quot;, math_format(10^.x))) +
  scale_y_log10(expression(&amp;quot;Brain weight (log&amp;quot;[&amp;quot;10&amp;quot;]*&amp;quot;(g))&amp;quot;),
                breaks = trans_breaks(&amp;quot;log10&amp;quot;, function(x) 10^x),
                labels = trans_format(&amp;quot;log10&amp;quot;, math_format(10^.x))) +
  annotation_logticks() +
  theme_classic() +
  coord_fixed(xlim = c(1e-3, 1e4), ylim = c(1e-1, 1e4)) +
  theme(text = element_text(family = &amp;quot;Times&amp;quot;))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2018-09-06-gmds-tutorium-2018-datenvisualisierung-in-r-mit-ggplot2_files/figure-html/unnamed-chunk-8-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
</content>
      
    </item>
    
    <item>
      <title>GMDS Tutorium 2018 - Der Einstieg in die Programmiersprache R</title>
      <link>/post/r-tutorium-gmds-2018/</link>
      <pubDate>Thu, 06 Sep 2018 00:00:00 +0000</pubDate>
      <author>Jens Hüsers</author>
      <guid>/post/r-tutorium-gmds-2018/</guid>
      <description>My tutorial on ‘Introduction in R’ at the 63rd Annual Conference of the GMDS e.V. on Sep. 6th 2018 in Osnabrück.</description>
      
      <content>&lt;script src=&#34;//yihui.name/js/math-code.js&#34;&gt;&lt;/script&gt;
&lt;!-- Just one possible MathJax CDN below. You may use others. --&gt;
&lt;script async src=&#34;//mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML&#34;&gt;
&lt;/script&gt;
&lt;div id=&#34;preface&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Preface&lt;/h1&gt;
&lt;p&gt;Dieser Post enthält das Skript sowie die Aufgaben inklusive Lösungen meines Tutoriums “Einstieg in die Programmiersprache R” auf der 63. Jahrestagung der GMDS e.V. in Osnabrück am 6.9.2018. Das Skript mit den Aufgaben ohne Lösungen sind in der Datei &lt;code&gt;workbook-rstats-gmds18-aufgaben.Rmd&lt;/code&gt; auf &lt;a href=&#34;https://github.com/jnshsrs/gmds18-tutorium-rstats&#34; title=&#34;Github Repository&#34;&gt;Github&lt;/a&gt; verfügbar.&lt;/p&gt;
&lt;div id=&#34;installation&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Installation&lt;/h2&gt;
&lt;p&gt;In diesem Kurs werden wir mit R und RStudio als Programmierumgebung (IDE) arbeiten. Beide Programme stehen kostenlos zur Verfügung.&lt;/p&gt;
&lt;p&gt;Zunächst muss die Programmiersprache R installiert werden. Die aktuelle Version kann auf der offiziellen R-Website heruntergeladen werden (&lt;a href=&#34;http://www.r-project.org&#34; class=&#34;uri&#34;&gt;http://www.r-project.org&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;Danach kann RStudio installiert werden, welches unter der Open Source Lizenz kostenlos zur Verfügung steht (&lt;a href=&#34;https://www.rstudio.com/products/rstudio/download/&#34; class=&#34;uri&#34;&gt;https://www.rstudio.com/products/rstudio/download/&lt;/a&gt;).&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;warum-r&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Warum R?&lt;/h2&gt;
&lt;p&gt;R hat eine steile Lernkurve und häufig fällt der Einstieg ohne Ausbildung zum Informatiker oder “Computer Scientist”. Jedoch zahlt sich das Lernen für Personen aus, die in der Wissenschaft arbeiten.&lt;/p&gt;
&lt;p&gt;Welche Vorteile bieten Programmiersprachen im Vergleich zu den Statistiksoftwaretools wie SPSS und SAS?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Kostenlos mit vielen Erweiterungen und Unterstützung einer breiten R-Nutzergruppe (z.B. auf Stackoverflow)&lt;/li&gt;
&lt;li&gt;Dokumentation durch Computer Code&lt;/li&gt;
&lt;li&gt;Reproduzierbarkeit der Analysen&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Möglichkeit fremde Pakete zu nutzten oder eigene Pakete zu schreiben um eigenen Arbeits- und Analyseprozesse zu standardisieren.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;R ist auch ein Werkzeug bzw. ein Werkzeugkoffer, um “Statistik” zu verstehen und neue statistische Konzepte zu lernen.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;r-studio&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;R Studio&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Programmeinführung R-Studio&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;Dokumentation&lt;/li&gt;
&lt;li&gt;Umgebung (Enironment)&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Konsole&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;lern-ressourcen-und-materialien&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Lern-Ressourcen und Materialien&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;www.stackoverflow.com&#34;&gt;stackoverflow.com&lt;/a&gt; Online Forum, ein Fragesteller stellt eine Frage und jemand antwortet. Antworten können von anderen Nutzern bewertet werden&lt;/li&gt;
&lt;li&gt;R for Data Science (im Internet frei verfügbar)&lt;/li&gt;
&lt;li&gt;Twitter (z.B. &lt;span class=&#34;citation&#34;&gt;[@hadlywickham]&lt;/span&gt;(www.twitter.com(hadlywickham), &lt;span class=&#34;citation&#34;&gt;[@rdpeng]&lt;/span&gt;(&lt;a href=&#34;https://twitter.com/rdpeng&#34; class=&#34;uri&#34;&gt;https://twitter.com/rdpeng&lt;/a&gt;)))&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;www.datacamp.com&#34;&gt;DataCamp&lt;/a&gt;, &lt;a href=&#34;www.udemy.com&#34;&gt;Udemy&lt;/a&gt; (Kostenpflichtige eLearning Platformen im Bereich statistisches Programmieren und Data Science)&lt;/li&gt;
&lt;li&gt;kostenfreie Online-Lern Angebote auf Youtube z.B. &lt;a href=&#34;https://www.youtube.com/playlist?list=PLqzoL9-eJTNBDdKgJgJzaQcY6OXmsXAHU&#34;&gt;MarinStatsLectures&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.rstudio.com/resources/cheatsheets/&#34;&gt;Oft existieren für bestimmte Probleme sogenannte CheatSheets bzw. Spickzettel, welche die wichtigsten Kommandos zusammenfassen&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;kapitel-1---datenstrukturen&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Kapitel 1 - Datenstrukturen&lt;/h1&gt;
&lt;div id=&#34;einstieg-in-die-konsole-und-datentypen&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Einstieg in die Konsole und Datentypen&lt;/h2&gt;
&lt;p&gt;Vorab wichtig: R ist CaseSensitive, dass heißt, Groß- und Kleinbuchstaben sind unterschiedliche Zeichen. Der Großbuchstabe &lt;code&gt;X&lt;/code&gt; ist demnach nicht das selbe wie der Kleinbuchstabe x. Im R-Code werden daher zum Beispiel Variablennamen &lt;code&gt;x_mean&lt;/code&gt; und &lt;code&gt;X_mean&lt;/code&gt; unterschiedlich interpretiert.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Datentypen (Numerisch, Integer, String, Faktoren, Boolean)&lt;/li&gt;
&lt;li&gt;Integer (Ganzzahl) z.B. &lt;code&gt;100&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Numerisch (Float, Kommazahl) &lt;code&gt;0.12&lt;/code&gt; oder Ratio zweier Integer &lt;code&gt;1/10&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Boolean &lt;code&gt;TRUE&lt;/code&gt; or &lt;code&gt;FALSE&lt;/code&gt; (oder entprechend 1 und 0), werden in R als Datentyp &lt;code&gt;logical&lt;/code&gt; bezeichnet&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Zeichenkette, String &lt;code&gt;&amp;quot;Dies ist eine Zeichenkette&amp;quot;&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Datetime Datentyp (z.B. &lt;code&gt;as.Date(&amp;quot;2017-05-05&amp;quot;)&lt;/code&gt;, hier ist die Funktionseingabe eine Zeichenkette in einer bestimmten Reihenfolge Jahr-Monat-Tag)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;Besondere Datenwerte sind fehlende Werte z.B. &lt;code&gt;NA&lt;/code&gt; (Not available) oder &lt;code&gt;NaN&lt;/code&gt; (Not a Number z.B. &lt;code&gt;log(-10)&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;NULL&lt;/code&gt; Wert&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Zum Überprüfen des Datentyps gibt es verschiedene Funktionen z.B. &lt;code&gt;is.character()&lt;/code&gt;, &lt;code&gt;is.numeric()&lt;/code&gt; oder &lt;code&gt;is.logical()&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;(Build-In) Funktionen&lt;/li&gt;
&lt;li&gt;z.B. &lt;code&gt;abs()&lt;/code&gt;, &lt;code&gt;sqrt()&lt;/code&gt;, &lt;code&gt;nchar()&lt;/code&gt;, &lt;code&gt;mean()&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Dokumentation &lt;code&gt;?abs&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Funktions-Parameter&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Erstellen und Nutzten von Datenstrukturen (“Objekte” und “Klassen”)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;Vektoren &lt;code&gt;c()&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Liste: &lt;code&gt;list()&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;data.frame &lt;code&gt;data.frame()&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Es gibt noch weitere Datentypen, wie z.B. Matrix oder umfangreichere Strukturen wie z.B. Lineare Regressionsmodelle Da R Methoden für das objekt-orientierte Programmieren anbietet, können auch eigene Datenstrukturen entwickelt und genutzt werden.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;r-als-taschenrechner-kennenlernen-der-konsole&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;R als Taschenrechner (Kennenlernen der Konsole)&lt;/h2&gt;
&lt;p&gt;Wir können mathematische Operationen mit der R-Konsole berechen.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;1 + 1 # 2
1 - 1 # 0
2 * 4 # 8
2 / 4 # 1/2 oder .5

1 + 1/2
1 / 1  + 2
sqrt(9) + 3
sqrt(2)^2&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;In R ist es üblich Ergebnisse in einer Variable zu speichern. Das ist mit einem “Pfeil”&amp;quot; als Zuweisungsoperator &lt;code&gt;&amp;lt;-&lt;/code&gt; (ein kleiner als Zeichen gefolgt von einem Minuszeichen) möglich. Auch &lt;code&gt;=&lt;/code&gt; ist möglich, in R aber unüblich.&lt;/p&gt;
&lt;p&gt;Zum Beispiel kann die Summe aus der ersten Berechnung in einer Variablen &lt;code&gt;x&lt;/code&gt; und die Summe aus Berechnung zwei in &lt;code&gt;y&lt;/code&gt; gespeichert werden.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;x &amp;lt;- 1 + 1&lt;/code&gt; und &lt;code&gt;y &amp;lt;- 2 * 4&lt;/code&gt;, wobei x und y die Ergebnisse der Berechnung in Form eines numerischen Datentyps (s.u) speichern.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;x + y&lt;/code&gt; repräsentiert somit &lt;code&gt;(1 + 1) + (2 * 4)&lt;/code&gt; bzw. &lt;code&gt;2 + 8&lt;/code&gt;. R beachtet dabei Rechenregeln wie beispielsweise das Kommutativgesetzt oder das Assoziativgesetz.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;arbeiten-mit-vektoren&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Arbeiten mit Vektoren&lt;/h2&gt;
&lt;p&gt;Durchschnittlich Temperaturen in den kommenden sieben Tagen.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Erstellen eines Vektors
# Temperatur
# Daten aus Goolge https://www.google.com/search?q=google+wetter&amp;amp;ie=utf-8&amp;amp;oe=utf-8&amp;amp;client=firefox-b-ab 
# Suche am 19.4.2017
temperaturen &amp;lt;- c(27, 27, 22, 24, 13, 13, 13, 12)

# Was ist die höchste bzw. die kleinste Temperatur?
max_temp &amp;lt;- max(temperaturen)
min_temp &amp;lt;- min(temperaturen)
paste(&amp;quot;Der wärmste Tag wird&amp;quot;, max_temp, &amp;quot;Grad Celsius warm. Die kälteste&amp;quot;, min_temp, &amp;quot;Grad Celsius.&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;Der wärmste Tag wird 27 Grad Celsius warm. Die kälteste 12 Grad Celsius.&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;median(temperaturen) # Berechnen des Medians&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 17.5&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Extra Informationen: 
# Da der Median das 50% Quantil ist, kann dieser auch durch die Funktion `quantile` berechnet werden
# Diese Funktion erwartet zwei Argumente:
# Einen Vektor, der die Daten bzw. die Variable beinhaltet
# Zudem einen Vektor der die zu berechnenden Quantile beinhaltet
# Nähere Informationen durch `?quantile`
quantile(x = temperaturen, probs = c(.5)) # Das zweite Argument enthalt nur einen Wert (.5), da wir ausschließlich den Median errechnen möchten&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##  50% 
## 17.5&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;eigenschaften-von-vektoren&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Eigenschaften von Vektoren&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Vektoren Recycling&lt;/li&gt;
&lt;li&gt;Vektorisierte Operationen&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Beispiele für vektorisierte Operationen&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Messgerät unterschätzt jede Messung um einen Grad
temperaturen_unbiased &amp;lt;- temperaturen + 1

# Messgerät ist falsch kalibriert und überschätzt mit steigender Temperatur 
# die tatsächliche Temperatur (um 10%)
temperaturen * .9&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 24.3 24.3 19.8 21.6 11.7 11.7 11.7 10.8&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;task&#34;&gt;
&lt;p class=&#34;task&#34;&gt;
&lt;p&gt;&lt;strong&gt;Aufgabe:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Rechne die Temperaturen die im Vektor &lt;em&gt;temperaturen&lt;/em&gt; gespeichert sind in die Einheit Fahrenheit um.&lt;/p&gt;
&lt;p&gt;Dazu muss die Temperatur in Celsius mit 5/9 multipliziert und zu dieser Größe 32 addiert werden.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;temperaturen_fahrenheit &amp;lt;- temperaturen * 5/9 + 32
print(temperaturen_fahrenheit)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 47.00000 47.00000 44.22222 45.33333 39.22222 39.22222 39.22222 38.66667&lt;/code&gt;&lt;/pre&gt;
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;kapitel-2---funktionen&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Kapitel 2 - Funktionen&lt;/h1&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;/img/tut1-r-function.png&#34; alt=&#34;Syntaktische Aufbau einer Funktion in R&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;Syntaktische Aufbau einer Funktion in R&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;anwendungsbeispiel-mittelwert&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Anwendungsbeispiel Mittelwert&lt;/h2&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Mittelwert
mittelwert &amp;lt;- function(x) {
  n &amp;lt;- length(x) 
  sum_x &amp;lt;- sum(x)
  sum_x / n
}&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;task&#34;&gt;
&lt;p&gt;&lt;strong&gt;Aufgabe&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Erstellen Sie eine Funktion um die (empirische) Standardabweichung zu berechnen die wie in der folgenden Funktion definiert ist.&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(\sigma =\sqrt{\frac{1}{n-1}\cdot {\sum\limits_{i=1}^n} (x_i-\bar{x})^2}\)&lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Die Standardabweichung ist definiert als Wurzel des Mittelwerts folgender Größe: Der Summe der quadrierten Abweichung jedes Datenpunktes vom Mittelwert (SAQ).*&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Folgende Funktionen sind nützlich für die Erstellung dieser Funktion:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;length&lt;/code&gt; die Länge des Vektors&lt;/li&gt;
&lt;li&gt;&lt;code&gt;sum&lt;/code&gt; Summe eines Vektors&lt;/li&gt;
&lt;li&gt;&lt;code&gt;x^2&lt;/code&gt; Quadiert die Inhalte des Vektors &lt;code&gt;x&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Die (empirische) Standardabweichung beschreibt die Streuung einer Zufallsvariable. Je größer die Standardabweichung desto wahrscheinlich sind Datenpunkte, die eine höhere Distanz zum Mittelwert haben.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;source(&amp;quot;code/temperaturen.R&amp;quot;)
# Standardabweichung
standardabweichung &amp;lt;- function(x) {
  # Anzahl der Beobachtungen der Variablen
  n &amp;lt;- length(x)
  # Berechnung des Mittelwerts (die vorher definierte Funktion)
  mw &amp;lt;- mittelwert(x)
  # Berechnen der Summe der Abweichungsquadrate (saq)
  saq &amp;lt;- sum((x - mw)^2)
  # Berechnung der Standardabweichung
  stabw &amp;lt;- sqrt((1 / (n - 1)) * saq)
  return(stabw)
}

standardabweichung(temperaturen) &lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 6.749339&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Je kleiner die Standardabweichung, desto konstanter ist das Wetter in diesen Acht Tagen&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&#34;task&#34;&gt;
&lt;p&gt;&lt;strong&gt;Aufgabe&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Recherchiere bei Google die Temperaturen der kommenden Tage für Moskau und Los Angeles. Es werden bei Google das Wetter für den aktuellen Tag und der folgenden Woche angegeben.&lt;/p&gt;
&lt;p&gt;Schreib eine Funktion mit dem Namen &lt;code&gt;wettervorhersage&lt;/code&gt;. Diese Funktion hat einen Parameter (oder auch Funktionsargument genannt). Dieser Parameter ist ein numerischer Vektor (mit der Temperatur der kommenden Tage).&lt;/p&gt;
&lt;p&gt;Die Funktion soll die kleinste und die höchste Temperatur berechnen sowie die Standardabweichung und die Informationen als String zurück geben.&lt;/p&gt;
&lt;p&gt;In welcher Stadt ist besseres Wetter, wo ist das Wetter konstanter?&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;wettervorhersage &amp;lt;- function(x) {
  min_temp &amp;lt;- min(x)
  max_temp &amp;lt;- max(x)
  stabw &amp;lt;- standardabweichung(x)
  vorhersage &amp;lt;- paste0(&amp;quot;Die geringste Temperatur ist: &amp;quot;, min_temp, &amp;quot; und die höchste Temperatur &amp;quot;, max_temp, &amp;quot; Grad Celsius.&amp;quot;)
  konstant &amp;lt;- paste0(&amp;quot;Die Temperaturschwankung (gemessen durch die Standardabweichung) beträgt &amp;quot;, round(stabw, 2), &amp;quot; Grad Celsius.&amp;quot;)
  print(vorhersage)
  print(konstant)
}

los_angeles &amp;lt;- c(29, 31, 31, 28, 26, 26, 26, 26)
moskau &amp;lt;- c(19, 18, 10, 9, 9, 9, 8, 8)
  
wettervorhersage(los_angeles)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;Die geringste Temperatur ist: 26 und die höchste Temperatur 31 Grad Celsius.&amp;quot;
## [1] &amp;quot;Die Temperaturschwankung (gemessen durch die Standardabweichung) beträgt 2.23 Grad Celsius.&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;wettervorhersage(moskau)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;Die geringste Temperatur ist: 8 und die höchste Temperatur 19 Grad Celsius.&amp;quot;
## [1] &amp;quot;Die Temperaturschwankung (gemessen durch die Standardabweichung) beträgt 4.53 Grad Celsius.&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;kapitel-3---datensatz&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Kapitel 3 - Datensatz&lt;/h1&gt;
&lt;div id=&#34;arbeiten-mit-listen-und-data.frames&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Arbeiten mit Listen und data.frames&lt;/h2&gt;
&lt;p&gt;Ist eine Sammlung verschiedener Datentypen.&lt;/p&gt;
&lt;p&gt;Erstellen von Listen durch die Funktion &lt;code&gt;list()&lt;/code&gt;.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# In einem Vektor müssen die Elemente den gleichen Datentyp haben
# Welcher Datentyp besitzt der folgende Vektor?
c(&amp;quot;A&amp;quot;, 2)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;A&amp;quot; &amp;quot;2&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Die Liste muss nicht die selben Datentypen beinhalten (in Gegensatz zu einem Vektor)
# Beispielliste mit zwei Einträgen
beispielliste &amp;lt;- list(1, &amp;quot;B&amp;quot;)

# Wir können auch Vektoren als Listenelemente speichern 
temperaturen_liste &amp;lt;- list(temperaturen_la, temperaturen_moskau)

# Wir können sogar Funktionen in Listen speichern 
# Und wem das nicht genug ist, der speichert einfach eine Liste in einer Liste ;)
sinnlosse_beispielliste &amp;lt;- list(beispielliste, standardabweichung)
str(sinnlosse_beispielliste)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## List of 2
##  $ :List of 2
##   ..$ : num 1
##   ..$ : chr &amp;quot;B&amp;quot;
##  $ :function (x)  
##   ..- attr(*, &amp;quot;srcref&amp;quot;)= &amp;#39;srcref&amp;#39; int [1:8] 4 23 14 1 23 1 4 14
##   .. ..- attr(*, &amp;quot;srcfile&amp;quot;)=Classes &amp;#39;srcfilecopy&amp;#39;, &amp;#39;srcfile&amp;#39; &amp;lt;environment: 0x7fa701e91de0&amp;gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;datensatz-aka-data.frame&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Datensatz aka data.frame&lt;/h2&gt;
&lt;p&gt;Der &lt;code&gt;data.frame&lt;/code&gt;ist eine besondere Form der Liste. Er enthält &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; Vektoren der selben Länge &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;temperaturen &amp;lt;- data.frame(temperaturen_la, temperaturen_moskau)

# Mit verschiedenen Funktionen können wir den Datensatz darstellen
nrow(temperaturen) # Anzahl der Zeilen des Datensatzes&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 8&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ncol(temperaturen) # Anzahl der Spalten des Datensatzes&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 2&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;dim(temperaturen) # Anzahl der Zeilen und Spalten &lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 8 2&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;str(temperaturen) # Struktur des Datensates&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## &amp;#39;data.frame&amp;#39;:    8 obs. of  2 variables:
##  $ temperaturen_la    : num  18 22 26 26 25 24 23 22
##  $ temperaturen_moskau: num  16 14 18 8 8 12 12 13&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;head(temperaturen, n = 2) # Zwei Funktionsargumente, n ist die Anzahl der Zeilen, welche angezeigt werden sollen&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##   temperaturen_la temperaturen_moskau
## 1              18                  16
## 2              22                  14&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tail(temperaturen, n = 2) &lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##   temperaturen_la temperaturen_moskau
## 7              23                  12
## 8              22                  13&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;colnames(temperaturen) # Spaltennamen&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;temperaturen_la&amp;quot;     &amp;quot;temperaturen_moskau&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;class(temperaturen) # Klasse des Objekts (in diesem Fall `data.frame`)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;data.frame&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;operationen-mit-datensatzen-data.frames&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Operationen mit Datensätzen (data.frames)&lt;/h2&gt;
&lt;p&gt;Oft möchte man nur mit Ausschnitten des Datensatzes arbeiten. R bietet die Möglichkeit einzelne Spalten (Variablen) des Datensatzes auszuwählen sowie einzelne Zeilen auszuwählen. Für unseren Datensatz mit den Temperaturen könnten wir z.B. ausschließlich die Temperaturen für das Wochenende und nur für Los Angeles auswählen.&lt;/p&gt;
&lt;p&gt;Es gibt mehrere Möglichkeiten, eine Auswahl eines Datensatzes zu erzeugen. Wenn wir einzelne Spalten eines Datensatzes auswählen möchten, eignet sich die &lt;code&gt;$&lt;/code&gt;(Dollar)-Notation. Dabei wird über den Datensatznamen und den Spaltennamen, die durch ein &lt;code&gt;$&lt;/code&gt; verknüft werden auf die spezielle Spalte zugegriffen: &lt;code&gt;datensatz_name$spaltenname&lt;/code&gt; Wenn wir auf die Spalte &lt;code&gt;temperaturen_la&lt;/code&gt; unseres Datensatzes &lt;code&gt;temperaturen&lt;/code&gt; zugreifen wolle, könnten wir dieses durch den Befehl &lt;code&gt;temperaturen$temperaturen_la&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;In diesem Fall ist das Ergebnis ein Vektor mit den Daten aus der abgefragten Spalte &lt;code&gt;temperaturen_la&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Die &lt;code&gt;$&lt;/code&gt;-Notation ermöglicht es uns nicht nur, auf einzelne Spalten zurückzugreifen, sondern auch neue Spalten zu erstellen.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;data.frame$neue_spalte &amp;lt;- x 
# wobei x ein Vektor mit neuen Daten ist, z.B. das Datum der entsprechenden Tage 

temperaturen$temperaturen_kairo &amp;lt;- c(36, 35, 37, 37, 36, 35, 34, 34)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;importieren-eines-datensatzes&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Importieren eines Datensatzes&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;/img/tut1-r-csv-rows.png&#34; style=&#34;width:45.0%&#34; /&gt; &lt;img src=&#34;/img/tut1-r-csv-columns.png&#34; style=&#34;width:45.0%&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Der Datensatz, in R als &lt;code&gt;data.frame&lt;/code&gt; bezeichnet, ist eine zentrale Datenstruktur, die bei Datenanalysen zum Einsatz kommt. Viele Datensätze sind so formatiert, dass sie direkt in R importiert werden können. So können zum Beispiel &lt;code&gt;data.frames&lt;/code&gt; aus Excel, SPSS oder SAS direkt importiert werden.&lt;/p&gt;
&lt;p&gt;Häufig liegen diese Daten jedoch in Textdateien im CSV-Format vor. CSV steht für Komma-separierte-Werte (engl. comma-separated-values). Mit Hilfe der Funktion &lt;code&gt;read.csv&lt;/code&gt; können Dateien im CSV-Format in R eingelesen werden.&lt;/p&gt;
&lt;p&gt;Wir verwenden in diesem Tutorial den &lt;a href=&#34;https://www.kaggle.com/c/titanic&#34;&gt;Titanic Datensatz&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;/img/titanic-new-york-herald.jpeg&#34; alt=&#34;Headline of THE NEW YORK HERALD 15th of April 1912&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;Headline of THE NEW YORK HERALD 15th of April 1912&lt;/p&gt;
&lt;/div&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;titanic &amp;lt;- read.csv(&amp;quot;data/titanic.csv&amp;quot;)

library(tidyverse)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: package &amp;#39;ggplot2&amp;#39; was built under R version 3.5.2&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: package &amp;#39;tibble&amp;#39; was built under R version 3.5.2&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: package &amp;#39;tidyr&amp;#39; was built under R version 3.5.2&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: package &amp;#39;purrr&amp;#39; was built under R version 3.5.2&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: package &amp;#39;dplyr&amp;#39; was built under R version 3.5.2&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: package &amp;#39;stringr&amp;#39; was built under R version 3.5.2&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: package &amp;#39;forcats&amp;#39; was built under R version 3.5.2&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;head(titanic)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##   pclass survived                                            name    sex
## 1      1        1                   Allen, Miss. Elisabeth Walton female
## 2      1        1                  Allison, Master. Hudson Trevor   male
## 3      1        0                    Allison, Miss. Helen Loraine female
## 4      1        0            Allison, Mr. Hudson Joshua Creighton   male
## 5      1        0 Allison, Mrs. Hudson J C (Bessie Waldo Daniels) female
## 6      1        1                             Anderson, Mr. Harry   male
##     age sibsp parch ticket     fare   cabin embarked boat body
## 1 29.00     0     0  24160 211.3375      B5        S    2   NA
## 2  0.92     1     2 113781 151.5500 C22 C26        S   11   NA
## 3  2.00     1     2 113781 151.5500 C22 C26        S   NA   NA
## 4 30.00     1     2 113781 151.5500 C22 C26        S   NA  135
## 5 25.00     1     2 113781 151.5500 C22 C26        S   NA   NA
## 6 48.00     0     0  19952  26.5500     E12        S    3   NA
##                         home.dest
## 1                    St Louis, MO
## 2 Montreal, PQ / Chesterville, ON
## 3 Montreal, PQ / Chesterville, ON
## 4 Montreal, PQ / Chesterville, ON
## 5 Montreal, PQ / Chesterville, ON
## 6                    New York, NY&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Diese spezielle R-Syntax erlaubt es, auf einzelne Spalten eines Datensatzes zuzugreifen.&lt;/p&gt;
&lt;p&gt;Eine weitere Möglichkeit auf eine Auswahl des Datensatzes zist die sogenannten &lt;code&gt;[&lt;/code&gt;-Notation, wobei &lt;code&gt;[&lt;/code&gt; als “bracket” oder “Eckige Klammer” bezeichnet wird. Diese hat folgende Syntax: &lt;code&gt;datensatz[zeilenfilter, vektor mit den spaltennamen]&lt;/code&gt;. &lt;code&gt;datensatz&lt;/code&gt; bezeichnet den Namen des spezifischen Datensatzes, unser erstellter Datensatz hat den Namen. In die folgenden eckigen Klammern wird die Auswahl des Datensatzes spezifiziert. Vor dem Komma wird der Zeilenfilter gesetzt, nach der Klammer ein &lt;code&gt;character&lt;/code&gt; Vektor, der die Namen der ausgewählten Spalten enthält. Das Resultat ist ein neuer Datensatz, ausschließlich mit den Zeilen und Spalten, die ausgewählt wurden.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;auswahlen-von-zeilen-und-spalten&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Auswählen von Zeilen und Spalten&lt;/h2&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;titanic[, &amp;quot;age&amp;quot;] # Nur Spalte Age
titanic[1, ] # Nur erste Zeile
titanic[c(1, 2), c(&amp;quot;age&amp;quot;, &amp;quot;sex&amp;quot;)] # gibt die ersten beiden Zeilen und die Spalten Alter und Geschlecht wieder
titanic[titanic$age &amp;lt;= 18, ] # gibt die ersten beiden Zeilen und die Spalten Alter und Geschlecht wieder
titanic[titanic$sex == &amp;quot;male&amp;quot;, ] # gibt die ersten beiden Zeilen und die Spalten Alter und Geschlecht wieder&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;Cave: Oben habe ich geschrieben, das Ergebnis sei eine neuer Datensatz, also ein R-Objekt des Typs `data.frame´. Wenn nur eine Spalte ausgewählt wird, ist das Ergebnis ein Vektor&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;task&#34;&gt;
&lt;p&gt;&lt;strong&gt;Aufgabe&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Wie viele Passagiere waren auf der Reise unter 18 Jahre alt?&lt;/li&gt;
&lt;li&gt;Was ist das durchschnittliche Alter der Männer und der Frauen?&lt;/li&gt;
&lt;li&gt;Wie hoch ist der durchschnittliche Ticktpreis (&lt;code&gt;fare&lt;/code&gt;-Spalte)&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Anzahl unter 18-jähriger Passagiere
nrow(titanic[titanic$age &amp;lt; 18, ])&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 417&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Durchschnittlicher Alter Herren
mean(titanic$age[titanic$sex == &amp;quot;male&amp;quot;], na.rm = TRUE)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 30.58523&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Durchschnittliches Alter Damen
mean(titanic$age[titanic$sex == &amp;quot;female&amp;quot;], na.rm = TRUE)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 28.68709&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Durchschnittliche Ticketpreis
mean(titanic$fare, na.rm = TRUE)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 33.29548&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;kapitel-4---tidyverse&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Kapitel 4 - Tidyverse&lt;/h1&gt;
&lt;div id=&#34;nutzen-von-paketen&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Nutzen von Paketen&lt;/h2&gt;
&lt;p&gt;Bisher haben wir uns mit den Standardfunktionen von R befasst. Zudem haben wir eine Funktions selber geschrieben.&lt;/p&gt;
&lt;p&gt;Häufig entwickeln Statistiker und Programmierer Erweiterungen, die auch Pakete genannt werden, die wir als sogenannte &lt;code&gt;library&lt;/code&gt; nutzten können.&lt;/p&gt;
&lt;p&gt;Eine der zentralen Erweiterungen in R momentan ist das Paket &lt;code&gt;tidyverse&lt;/code&gt;. Es erweitert den Funktionsumfang von data.frames. Diese weiterentwickelte data.frame wir auch als &lt;code&gt;tibble&lt;/code&gt; bezeichnet.&lt;/p&gt;
&lt;p&gt;Pakete wie &lt;code&gt;tidyverse&lt;/code&gt; müssen zusätzlich installiert werden. Dies gelingt durch die Funktion &lt;code&gt;install.packages&lt;/code&gt; z.B. &lt;code&gt;install.package(tidyverse)&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Um das Paket zu nutzten müssen wir es zunächst laden. Dies gelingt durch den Funktionsaufruf &lt;code&gt;library(tidyverse)&lt;/code&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;importieren-von-daten&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Importieren von Daten&lt;/h2&gt;
&lt;p&gt;Auch Tidyverse-Paket hat eine Funktion, um Daten im CSV-Formtat zu importieren (und auch zu exportieren). Diese Funktion hat den Vorteil, dass sie die Daten schneller liest und den Datentyp einzelner Spalten zuverlässiger erkennt.&lt;/p&gt;
&lt;p&gt;Die Funktion heißt &lt;code&gt;read_csv&lt;/code&gt; (nicht verwechseln mit der Funktion &lt;code&gt;read.csv&lt;/code&gt; die mit einem Punkt geschrieben wird). Die Dokumentation erhalten wir durch &lt;code&gt;?read_csv&lt;/code&gt;.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(tidyverse)
titanic &amp;lt;- read_csv(&amp;quot;data/titanic.csv&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Es existieren in R Erweiterung die Schnittstellen und Importmöglichkeiten für andere Datenformate bieten:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;SPSS &lt;code&gt;haven::read_sav(file = &amp;quot;data/titanic.sav&amp;quot;)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Excel &lt;code&gt;readxl::read_xlsx(file = &amp;quot;data/titanic.xlsx&amp;quot;)&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;task&#34;&gt;
&lt;p&gt;&lt;strong&gt;Aufgabe&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Nutzen sie die beiden Funktionen um den Datensatz als data.frame zu importieren. Speichern Sie den jeweiligen Datensatz in einer Variable.&lt;/p&gt;
&lt;p&gt;Berechnen Sie den Mittelwert des Alters und vergleichen Sie die Ergebnisse.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# einlesen des SPSS Datensatzes mit dem haven Paket
titanic_sav &amp;lt;- haven::read_sav(file = &amp;quot;data/titanic.sav&amp;quot;)
head(titanic_sav) # ersten sechs Zeilen des Datensatzes&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 6 x 14
##   pclass survived name  sex     age sibsp parch ticket  fare cabin embarked
##    &amp;lt;dbl&amp;gt;    &amp;lt;dbl&amp;gt; &amp;lt;chr&amp;gt; &amp;lt;chr&amp;gt; &amp;lt;dbl&amp;gt; &amp;lt;dbl&amp;gt; &amp;lt;dbl&amp;gt; &amp;lt;chr&amp;gt;  &amp;lt;dbl&amp;gt; &amp;lt;chr&amp;gt; &amp;lt;chr&amp;gt;   
## 1      1        1 Alle… fema… 29        0     0 24160  211.  B5    S       
## 2      1        1 Alli… male   0.92     1     2 113781 152.  C22 … S       
## 3      1        0 Alli… fema…  2        1     2 113781 152.  C22 … S       
## 4      1        0 Alli… male  30        1     2 113781 152.  C22 … S       
## 5      1        0 Alli… fema… 25        1     2 113781 152.  C22 … S       
## 6      1        1 Ande… male  48        0     0 19952   26.6 E12   S       
## # … with 3 more variables: boat &amp;lt;chr&amp;gt;, body &amp;lt;dbl&amp;gt;, home.dest &amp;lt;chr&amp;gt;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;summary(titanic_sav) # Zusammenfassung des Datensatzes&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##      pclass         survived         name               sex           
##  Min.   :1.000   Min.   :0.000   Length:1309        Length:1309       
##  1st Qu.:2.000   1st Qu.:0.000   Class :character   Class :character  
##  Median :3.000   Median :0.000   Mode  :character   Mode  :character  
##  Mean   :2.295   Mean   :0.382                                        
##  3rd Qu.:3.000   3rd Qu.:1.000                                        
##  Max.   :3.000   Max.   :1.000                                        
##                                                                       
##       age            sibsp            parch          ticket         
##  Min.   : 0.17   Min.   :0.0000   Min.   :0.000   Length:1309       
##  1st Qu.:21.00   1st Qu.:0.0000   1st Qu.:0.000   Class :character  
##  Median :28.00   Median :0.0000   Median :0.000   Mode  :character  
##  Mean   :29.88   Mean   :0.4989   Mean   :0.385                     
##  3rd Qu.:39.00   3rd Qu.:1.0000   3rd Qu.:0.000                     
##  Max.   :80.00   Max.   :8.0000   Max.   :9.000                     
##  NA&amp;#39;s   :263                                                        
##       fare            cabin             embarked        
##  Min.   :  0.000   Length:1309        Length:1309       
##  1st Qu.:  7.896   Class :character   Class :character  
##  Median : 14.454   Mode  :character   Mode  :character  
##  Mean   : 33.295                                        
##  3rd Qu.: 31.275                                        
##  Max.   :512.329                                        
##  NA&amp;#39;s   :1                                              
##      boat                body        home.dest        
##  Length:1309        Min.   :  1.0   Length:1309       
##  Class :character   1st Qu.: 72.0   Class :character  
##  Mode  :character   Median :155.0   Mode  :character  
##                     Mean   :160.8                     
##                     3rd Qu.:256.0                     
##                     Max.   :328.0                     
##                     NA&amp;#39;s   :1188&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# einlesen des Excel Datensatzes
titanic_xlsx &amp;lt;- readxl::read_xlsx(&amp;quot;data/titanic.xlsx&amp;quot;)

# Berechnen der Mittelwerte des Alters in der Spalte `age`  
mean(titanic$age, na.rm = TRUE)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 29.88114&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;mean(titanic_sav$age, na.rm = TRUE)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 29.88114&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;mean(titanic_xlsx$age, na.rm = TRUE)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 29.88114&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;arbeiten-mit-dem-tidyverse&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Arbeiten mit dem tidyverse&lt;/h2&gt;
&lt;p&gt;Das tidyverse bedient sich einer einfachen Syntax und 5 zentralen Funktionen. Das besondere der Syntax ist das aneinanderreihen von (tidyverse) Funktionen. Der Pipe-Operator verbindet Funktionen und gibt den Funktionsoutput der vorangegangenen Funktion in die folgende Funktion als Funktionsinput weiter. Der Pipe Operator wird mit der Syntax &lt;code&gt;%&amp;gt;%&lt;/code&gt; (Prozentzeichen, größer-Zeichen, Prozentzeichen) verwendet. Fast alle Funktionen im tidyverse erwarten einen &lt;code&gt;data.frame&lt;/code&gt; als Funktionsinput und geben einen manipulierten &lt;code&gt;data.frame&lt;/code&gt; zurück.&lt;/p&gt;
&lt;p&gt;Die fünf zentralen Funktionen sind Verben, die ausdrücken, was die jeweilige Funktion “tut”.&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;/img/tut1-r-dplyr-functions.png&#34; alt=&#34;Auswahl wichtiger dplyr-Funktionen&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;Auswahl wichtiger dplyr-Funktionen&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;beispiele&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;Beispiele&lt;/h4&gt;
&lt;p&gt;&lt;em&gt;Umrechnung der Fahrpreises&lt;/em&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;titanic %&amp;gt;% 
  mutate(fare = fare * 11.25) %&amp;gt;%
  arrange(fare) %&amp;gt;% tail&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 6 x 14
##   pclass survived name  sex     age sibsp parch ticket  fare cabin embarked
##    &amp;lt;dbl&amp;gt;    &amp;lt;dbl&amp;gt; &amp;lt;chr&amp;gt; &amp;lt;chr&amp;gt; &amp;lt;dbl&amp;gt; &amp;lt;dbl&amp;gt; &amp;lt;dbl&amp;gt; &amp;lt;chr&amp;gt;  &amp;lt;dbl&amp;gt; &amp;lt;chr&amp;gt; &amp;lt;chr&amp;gt;   
## 1      1        1 Fort… fema…  60       1     4 19950  2959. C23 … S       
## 2      1        1 Card… male   36       0     1 PC 17… 5764. B51 … C       
## 3      1        1 Card… fema…  58       0     1 PC 17… 5764. B51 … C       
## 4      1        1 Lesu… male   35       0     0 PC 17… 5764. B101  C       
## 5      1        1 Ward… fema…  35       0     0 PC 17… 5764. &amp;lt;NA&amp;gt;  C       
## 6      3        0 Stor… male   60.5     0     0 3701     NA  &amp;lt;NA&amp;gt;  S       
## # … with 3 more variables: boat &amp;lt;dbl&amp;gt;, body &amp;lt;dbl&amp;gt;, home.dest &amp;lt;chr&amp;gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;em&gt;Die ältesten 3 überlebenden Passagiere&lt;/em&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;titanic %&amp;gt;% 
  mutate(survived = if_else(survived == 1, TRUE, FALSE)) %&amp;gt;% 
  filter(survived) %&amp;gt;% 
  select(name, age, pclass) %&amp;gt;% 
  arrange(age) %&amp;gt;% 
  tail(n = 3)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 3 x 3
##   name                                                age pclass
##   &amp;lt;chr&amp;gt;                                             &amp;lt;dbl&amp;gt;  &amp;lt;dbl&amp;gt;
## 1 Shine, Miss. Ellen Natalia                           NA      3
## 2 Smyth, Miss. Julia                                   NA      3
## 3 Thorneycroft, Mrs. Percival (Florence Kate White)    NA      3&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;task&#34;&gt;
&lt;p&gt;&lt;strong&gt;Aufgabe&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Welche Passagiere haben den Höchsten Preis für die Reise bezahlt?&lt;/p&gt;
&lt;p&gt;Geben Sie den Namen und den Fahrpreis in der finale Tablle aus.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;titanic %&amp;gt;% 
  select(name, fare) %&amp;gt;% 
  arrange(desc(fare)) %&amp;gt;% 
  head(n = 10)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 10 x 2
##    name                                                             fare
##    &amp;lt;chr&amp;gt;                                                           &amp;lt;dbl&amp;gt;
##  1 Cardeza, Mr. Thomas Drake Martinez                               512.
##  2 Cardeza, Mrs. James Warburton Martinez (Charlotte Wardle Drake)  512.
##  3 Lesurer, Mr. Gustave J                                           512.
##  4 Ward, Miss. Anna                                                 512.
##  5 Fortune, Miss. Alice Elizabeth                                   263 
##  6 Fortune, Miss. Ethel Flora                                       263 
##  7 Fortune, Miss. Mabel Helen                                       263 
##  8 Fortune, Mr. Charles Alexander                                   263 
##  9 Fortune, Mr. Mark                                                263 
## 10 Fortune, Mrs. Mark (Mary McDougald)                              263&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;https://www.encyclopedia-titanica.org/titanic-survivor/thomas-cardeza.html&#34;&gt;Extrainfos&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;&lt;em&gt;Was ist das durchschnittliche Alter der Passagiere?&lt;/em&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Zusammenfassen durch den Mittelwert - &lt;code&gt;summarise&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;titanic %&amp;gt;% 
  summarise(age_mean = mean(age, na.rm = T))&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 1 x 1
##   age_mean
##      &amp;lt;dbl&amp;gt;
## 1     29.9&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;em&gt;Was ist das durchschnittliche Alter der männlichen und weiblichen Passagiere und was ist die Standardabeichung des Alters?&lt;/em&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Gruppen erstellen entsprechend des Geschlechts - &lt;code&gt;group_by&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Zusammenfassen durch den Mittelwert - &lt;code&gt;summarise&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;titanic %&amp;gt;% 
  group_by(sex) %&amp;gt;% 
  summarise(age_mean = mean(age, na.rm = T), age_sd = sd(age, na.rm = T), n = n())&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 2 x 4
##   sex    age_mean age_sd     n
##   &amp;lt;chr&amp;gt;     &amp;lt;dbl&amp;gt;  &amp;lt;dbl&amp;gt; &amp;lt;int&amp;gt;
## 1 female     28.7   14.6   466
## 2 male       30.6   14.3   843&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;task&#34;&gt;
&lt;p&gt;&lt;strong&gt;Aufgabe&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Was ist der durchschnittliche Fahrpreis und die jeweilige Streuung für die jeweiligen Klassen?&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;titanic %&amp;gt;% 
  group_by(pclass) %&amp;gt;% 
  summarise(durchschnittl_fahrpreis = mean(fare, na.rm = TRUE))&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 3 x 2
##   pclass durchschnittl_fahrpreis
##    &amp;lt;dbl&amp;gt;                   &amp;lt;dbl&amp;gt;
## 1      1                    87.5
## 2      2                    21.2
## 3      3                    13.3&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&#34;task&#34;&gt;
&lt;p&gt;&lt;strong&gt;Aufgabe&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Der &lt;em&gt;New York Herold&lt;/em&gt; titelte am 15.April 1912: &lt;em&gt;The Titanic sinks with 1800 on board; only 675 mostly women and children, saved&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Finden sie heraus, ob diese Schlagzeile aus den Daten nachvollziehbar ist, indem Sie die Funktionen des &lt;code&gt;tidyverse&lt;/code&gt; anwenden.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;titanic %&amp;gt;%  
  group_by(survived, sex) %&amp;gt;%  
  summarise(n = n()) %&amp;gt;%  
  ungroup() %&amp;gt;%  
  mutate(prop = n / sum(n)) &lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 4 x 4
##   survived sex        n   prop
##      &amp;lt;dbl&amp;gt; &amp;lt;chr&amp;gt;  &amp;lt;int&amp;gt;  &amp;lt;dbl&amp;gt;
## 1        0 female   127 0.0970
## 2        0 male     682 0.521 
## 3        1 female   339 0.259 
## 4        1 male     161 0.123&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&#34;task&#34;&gt;
&lt;p&gt;&lt;strong&gt;Aufgabe&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Es ist bekannt dass die Rettungsboote auf der Titanic nicht ausgelastet waren. Nun sollen Sie die tatsächliche Auslasung der Rettungsboote auf der Titanic berechnen.&lt;/p&gt;
&lt;p&gt;Die Informationen ob und in welches Rettungsboot ein Gast bestieg ist in der Spalte &lt;code&gt;boat&lt;/code&gt; des Titanic Datensatzes vermerkt.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# auslastung pro boot 
auslastung_pro_boot &amp;lt;- titanic %&amp;gt;%  
  filter(!is.na(boat)) %&amp;gt;%  
  group_by(boat) %&amp;gt;%  
  summarise(n = n()) %&amp;gt;%  
  mutate(auslastung = n / 65) 
   
# auslastung aller boote 
auslastung_aller_boote &amp;lt;- auslastung_pro_boot %&amp;gt;%  
  summarise(auslastung = mean(auslastung)) 
 
print(auslastung_pro_boot) &lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 16 x 3
##     boat     n auslastung
##    &amp;lt;dbl&amp;gt; &amp;lt;int&amp;gt;      &amp;lt;dbl&amp;gt;
##  1     1     5     0.0769
##  2     2    13     0.2   
##  3     3    26     0.4   
##  4     4    31     0.477 
##  5     5    30     0.462 
##  6     6    20     0.308 
##  7     7    23     0.354 
##  8     8    24     0.369 
##  9     9    25     0.385 
## 10    10    29     0.446 
## 11    11    25     0.385 
## 12    12    19     0.292 
## 13    13    42     0.646 
## 14    14    33     0.508 
## 15    15    38     0.585 
## 16    16    23     0.354&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;print(auslastung_aller_boote) &lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 1 x 1
##   auslastung
##        &amp;lt;dbl&amp;gt;
## 1      0.390&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;kapitel-5---grafiken&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Kapitel 5 - Grafiken&lt;/h1&gt;
&lt;p&gt;In R gibt es drei wichtige Softwarepakete um Grafiken zu erstellen.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;base&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;lattice&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ggplot2&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;An dieser Stelle wird ein kurzer Ausblick auf das Basispaket in gegeben und zwei weesentliche Funktionen vorgestellt.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;XY-Plots&lt;/li&gt;
&lt;li&gt;Histogramme&lt;/li&gt;
&lt;li&gt;Boxplots&lt;/li&gt;
&lt;/ul&gt;
&lt;div id=&#34;xy-plots&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;XY-Plots&lt;/h3&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;par(mfrow = c(1,2)) 
# Bivariate Darstellung des Alters und des Preises 
plot(titanic$age, titanic$fare) 
plot(titanic$age, titanic$fare, col = titanic$pclass) &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2018-09-06-r-tutorium-gmds-2018_files/figure-html/unnamed-chunk-19-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;par(mfrow = c(1, 1)) &lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;histogramme&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Histogramme&lt;/h3&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;hist(titanic$age) &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2018-09-06-r-tutorium-gmds-2018_files/figure-html/unnamed-chunk-20-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;boxplots&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Boxplots&lt;/h3&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;boxplot(titanic$age) &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2018-09-06-r-tutorium-gmds-2018_files/figure-html/unnamed-chunk-21-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;ruckblick-und-ausblick&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Rückblick und Ausblick&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Vom elementaren Datentyp über Vektoren zu Listen und data.frames&lt;/li&gt;
&lt;li&gt;&lt;code&gt;data.frames&lt;/code&gt; stellen das zentrale Datenelement im tidyverse dar&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Das &lt;code&gt;tidyverse&lt;/code&gt; ist der Werkzeigkasten in R zur Datenmanipulation&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;Weiter wichtige Funktionen z.B. aus der Inferenzstatistik sind in R vorhanden z.B. &lt;code&gt;?t.test&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Ein großer Funktionsumfrang zum Modellieren von Daten z.B. von Lineare Regression bis zur Neuronalen Netzen&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Weitere statistische Operationen wie z.B. Konfidenzintervalle und Inferenzstatistik (t.tests)&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;titanic %&amp;gt;% 
  group_by(sex) %&amp;gt;% 
  filter(age &amp;gt;= 18) %&amp;gt;% 
  summarise(ci = list(Hmisc::smean.cl.boot(age))) %&amp;gt;% 
  mutate_at(&amp;quot;ci&amp;quot;, ~ map(.x, enframe)) %&amp;gt;% 
  unnest(ci) %&amp;gt;% 
  spread(key = name, value = value)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 2 x 4
##   sex    Lower  Mean Upper
##   &amp;lt;chr&amp;gt;  &amp;lt;dbl&amp;gt; &amp;lt;dbl&amp;gt; &amp;lt;dbl&amp;gt;
## 1 female  31.8  33.2  34.5
## 2 male    32.7  33.6  34.6&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;/img/tut1-example-plot.png&#34; /&gt;
&lt;hr&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;/img/tut1-r-decision-tree.png&#34; /&gt;

&lt;/div&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(rpart) # Paket mit dem Entscheidungsbäume erstellt werden können
library(rattle) # Paket mit dem Entscheidungsbäume visualisiert werden können

titanic %&amp;gt;% 
  ggplot(aes(x = factor(pclass), y = fare)) + 
  stat_summary(fun.data = mean_cl_boot, geom = &amp;quot;errorbar&amp;quot;, width = .15, size = 1.25) + 
  stat_summary(fun.y = mean, geom = &amp;quot;point&amp;quot;, size = 2) +
  geom_point(alpha = .05) +
  ylab(&amp;quot;Fahrpreis in Dollar (1912)&amp;quot;) +
  scale_x_discrete(labels = c(&amp;quot;1. Klasse&amp;quot;, &amp;quot;2. Klasse&amp;quot;, &amp;quot;3. Klasse&amp;quot;)) +
  scale_y_continuous(label = scales::dollar_format(), breaks = seq(0, 120, by = 20), limits = c(0, 120)) +
  theme_bw() +
  theme(axis.title.x = element_blank(), 
        axis.text = element_text(size = 12))&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: Removed 68 rows containing non-finite values (stat_summary).

## Warning: Removed 68 rows containing non-finite values (stat_summary).&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: Removed 68 rows containing missing values (geom_point).&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2018-09-06-r-tutorium-gmds-2018_files/figure-html/unnamed-chunk-23-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;train &amp;lt;- titanic %&amp;gt;% select(survived, sex, age, pclass)
decision_tree &amp;lt;- rpart(survived ~ .,
                 data = train,
                 method =&amp;quot;class&amp;quot;)

fancyRpartPlot(decision_tree, main = &amp;quot;&amp;quot;, sub = &amp;quot;Welche Personen haben den Titanic-Untergang überlebt?&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2018-09-06-r-tutorium-gmds-2018_files/figure-html/unnamed-chunk-23-2.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
</content>
      
    </item>
    
    <item>
      <title>Join by rows</title>
      <link>/post/join-by-rows/</link>
      <pubDate>Fri, 03 Aug 2018 00:00:00 +0000</pubDate>
      <author>Jens Hüsers</author>
      <guid>/post/join-by-rows/</guid>
      <description></description>
      
      <content>&lt;p&gt;In a recent project I find myself often in the situation to deal with similar but not equal datasets. I am working with the German Hospital Registers for the years since 2005 and there is a dataset for each year.&lt;/p&gt;
&lt;p&gt;Some of them share the same information stored in columns and I had to combine them in a single dataframe.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(tidyverse)  &lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## ── Attaching packages ───────────────────────────────────────────────────────────────────────────────────────────────────────────────── tidyverse 1.2.1 ──&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## ✔ ggplot2 3.1.1       ✔ purrr   0.3.2  
## ✔ tibble  2.1.1       ✔ dplyr   0.8.0.1
## ✔ tidyr   0.8.3       ✔ stringr 1.4.0  
## ✔ readr   1.3.1       ✔ forcats 0.4.0&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: package &amp;#39;ggplot2&amp;#39; was built under R version 3.5.2&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: package &amp;#39;tibble&amp;#39; was built under R version 3.5.2&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: package &amp;#39;tidyr&amp;#39; was built under R version 3.5.2&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: package &amp;#39;purrr&amp;#39; was built under R version 3.5.2&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: package &amp;#39;dplyr&amp;#39; was built under R version 3.5.2&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: package &amp;#39;stringr&amp;#39; was built under R version 3.5.2&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: package &amp;#39;forcats&amp;#39; was built under R version 3.5.2&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## ── Conflicts ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# create two dataframes
widths &amp;lt;- iris %&amp;gt;% 
  select(Species, ends_with(&amp;quot;Width&amp;quot;))

lengths &amp;lt;- iris %&amp;gt;% 
  select(Species, ends_with(&amp;quot;Length&amp;quot;))


# dplyr::union(widths, lengths) # fails since not all columns are in both data.frames
# dplyr::intersect(widths, lengths) # fails since not all columns are in both data.frame
# dplyr::setdiff(widths, lengths) # fails since not all columns are in both data.frame
# dplyr::setequal(widths, lengths) # fails since not all columns are in both data.frame
dplyr::union_all(widths, lengths) %&amp;gt;% head # works, combines data.frames and fills with NA if column is not in one of the data.frames&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##   Species Sepal.Width Petal.Width Sepal.Length Petal.Length
## 1  setosa         3.5         0.2           NA           NA
## 2  setosa         3.0         0.2           NA           NA
## 3  setosa         3.2         0.2           NA           NA
## 4  setosa         3.1         0.2           NA           NA
## 5  setosa         3.6         0.2           NA           NA
## 6  setosa         3.9         0.4           NA           NA&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Since this set operations work in most of the cases, it will not in the case that I want to combine dataframes and only keep columns which are present in each dataframe.&lt;/p&gt;
&lt;p&gt;Therefore, I wrote the following function to handle this special case, which occures multiple times in my current project.&lt;/p&gt;
&lt;p&gt;The function &lt;code&gt;join_rows&lt;/code&gt; takes two or more data.frames and combines them in the fashion described above. Although the name might be misleading, since it is not a join by itself, for me it is a good description the task it does.&lt;/p&gt;
&lt;p&gt;The function takes multiple data.frames and returns a data.frame containing all columns which all data.frame share. The function furthermore adds an ID column to keep the source dataset.&lt;/p&gt;
&lt;p&gt;Notice that it does not reduce any duplicated rows, but keeps them.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;join_rows &amp;lt;- function(...) {
  dots &amp;lt;- rlang::exprs(...)
  data_frame_names &amp;lt;- paste(purrr::map(dots, rlang::expr_name))
  data_frames &amp;lt;- list(...)
  cols &amp;lt;- purrr::map(data_frames, names)
  cols &amp;lt;- purrr::reduce(cols, intersect)
  data_frames &amp;lt;- map(data_frames, select, cols)
  data_frames &amp;lt;- data_frames %&amp;gt;% set_names(data_frame_names)
  bind_rows(data_frames, .id = &amp;quot;id&amp;quot;)
}

# gives us one column (species) since that is the only column(-name) that is shared across both dataframes
join_rows(lengths, widths) %&amp;gt;% head&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##        id Species
## 1 lengths  setosa
## 2 lengths  setosa
## 3 lengths  setosa
## 4 lengths  setosa
## 5 lengths  setosa
## 6 lengths  setosa&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# will fail since 1 is not a data.frame
# join_rows(lengths, 1)&lt;/code&gt;&lt;/pre&gt;
</content>
      
    </item>
    
    <item>
      <title>Import ordered SPSS factors into R</title>
      <link>/post/import-ordered-spss-factors-into-r/</link>
      <pubDate>Wed, 18 Jul 2018 00:00:00 +0000</pubDate>
      <author>Jens Hüsers</author>
      <guid>/post/import-ordered-spss-factors-into-r/</guid>
      <description></description>
      
      <content>&lt;div id=&#34;spss-factor-variables&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;SPSS Factor Variables&lt;/h2&gt;
&lt;p&gt;Recently I have to work with data stored in SPSS files, most variables stored as ordered factor variables. Since I work with R, I have to import them. On the one hand, fortunatly, there is the &lt;code&gt;haven&lt;/code&gt; package, which makes importing SPSS files an easy taks. On the other hand, unfortunatly, ordered factors are imported as integer values which are not associated with the corresponding factor label. In consequence, it is very hard to tell what a integer value of a factor variable means. For example, when gender is stored as ordered factor variable, both genders are encoded as 1 for male and 2 for female. Since the mapping between the semantic of an encoded value is not explicit, SPSS associates those codes with there description expresst as string. R people know this as factor varible where numeric numbers are mapped to the factor labels.&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;haven&lt;/code&gt; package is able to read the associated labels with a numeric value of a factor variable, we can map both. Since I didn’t find an option to do this mapping and convertion with the functions in the &lt;code&gt;haven&lt;/code&gt; package, I wrote a function to complete the desired task.&lt;/p&gt;
&lt;p&gt;I created the following work around to directly import ordered SPSS factors as factors in R with its associated factor order and factor label.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# load magrittr to enable pipe operator
library(magrittr)

relabel_spss_variable &amp;lt;- function(x) {
  a &amp;lt;- base::attr(x = x, &amp;quot;labels&amp;quot;) 
  if(!is.null(a)) {
    labels = base::names(a)
    levels = base::as.character(a)
    base::factor(x = x, levels = levels, labels = labels, ordered = TRUE) 
  } else {
    warning(&amp;quot;x is not label. No relabelling done.&amp;quot;)
    x
  }
}&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# read spss file
# dataset from http://spss.allenandunwin.com.s3-website-ap-southeast-2.amazonaws.com/data-files.html
spss_file_url &amp;lt;- &amp;quot;http://spss.allenandunwin.com.s3-website-ap-southeast-2.amazonaws.com/Files/sleep.zip&amp;quot;
temp &amp;lt;- base::tempfile()
utils::download.file(spss_file_url, temp)
file &amp;lt;- base::unz(temp, &amp;quot;sleep.sav&amp;quot;)
spss &amp;lt;- haven::read_sav(file)
base::unlink(temp)

# subset spss dataset for presentation purpose
spss &amp;lt;- spss %&amp;gt;% dplyr::select(id:edlevel)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We can use the &lt;code&gt;$&lt;/code&gt; sign notation to convert one specific variable.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# convert variable
spss$edlevel_converted &amp;lt;- spss$edlevel %&amp;gt;% relabel_spss_variable
# numeric vector without factor labels
base::table(spss$edlevel)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
##   1   2   3   4   5 
##   3  33  30  71 132&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# factor variable with (ordered) labels
base::table(spss$edlevel_converted)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
##                          primary school 
##                                       3 
##                        secondary school 
##                                      33 
## trade training/ post secondary training 
##                                      30 
##                    undergraduate degree 
##                                      71 
##                     postgraduate degree 
##                                     132&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We can use functional programming to relabel every labeled variable in the dataframe.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;purrr::map_df(spss, relabel_spss_variable) %&amp;gt;% head&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning in .f(.x[[i]], ...): x is not label. No relabelling done.

## Warning in .f(.x[[i]], ...): x is not label. No relabelling done.

## Warning in .f(.x[[i]], ...): x is not label. No relabelling done.&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 6 x 6
##      id sex      age marital         edlevel            edlevel_converted  
##   &amp;lt;dbl&amp;gt; &amp;lt;ord&amp;gt;  &amp;lt;dbl&amp;gt; &amp;lt;ord&amp;gt;           &amp;lt;ord&amp;gt;              &amp;lt;ord&amp;gt;              
## 1    83 female    42 married/defacto secondary school   secondary school   
## 2   294 female    54 married/defacto postgraduate degr… postgraduate degree
## 3   425 male      NA married/defacto secondary school   secondary school   
## 4    64 female    41 married/defacto postgraduate degr… postgraduate degree
## 5   536 female    39 married/defacto postgraduate degr… postgraduate degree
## 6    57 female    66 married/defacto undergraduate deg… undergraduate degr…&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
</content>
      
    </item>
    
  </channel>
</rss>